(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{297:function(s,a,t){s.exports=t.p+"assets/img/image-20231110162101499.687af80d.png"},298:function(s,a,t){s.exports=t.p+"assets/img/image-20231111134731464.605aad82.png"},299:function(s,a,t){s.exports=t.p+"assets/img/image-20231115161438827.e1e10778.png"},300:function(s,a,t){s.exports=t.p+"assets/img/image-20231115161023803.fba1fc94.png"},301:function(s,a,t){s.exports=t.p+"assets/img/image-20231115160338325.b9b9ea0d.png"},302:function(s,a,t){s.exports=t.p+"assets/img/image-20231115162431186.10d89e21.png"},303:function(s,a,t){s.exports=t.p+"assets/img/image-20231115163918931.694fa8f0.png"},304:function(s,a,t){s.exports=t.p+"assets/img/image-20231115165537935.4e4b57b6.png"},305:function(s,a,t){s.exports=t.p+"assets/img/image-20231118142340774.91efecaa.png"},306:function(s,a,t){s.exports=t.p+"assets/img/image-20231118143715975.0917c07d.png"},307:function(s,a,t){s.exports=t.p+"assets/img/image-20240423163634328.e008e5dc.png"},308:function(s,a,t){s.exports=t.p+"assets/img/image-20240423164301885.e21c380f.png"},309:function(s,a,t){s.exports=t.p+"assets/img/image-20231118144403185.4c9a08d6.png"},310:function(s,a,t){s.exports=t.p+"assets/img/image-20240423150640835.48175b1e.png"},311:function(s,a,t){s.exports=t.p+"assets/img/image-20231118185524246.01cfa2d5.png"},312:function(s,a,t){s.exports=t.p+"assets/img/image-20240430165415446.f59619cc.png"},313:function(s,a,t){s.exports=t.p+"assets/img/image-20240501102511216.25badb9f.png"},617:function(s,a,t){"use strict";t.r(a);var e=t(14),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),a("h2",{attrs:{id:"什么是docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是docker"}},[s._v("#")]),s._v(" 什么是Docker?")]),s._v(" "),a("blockquote",[a("p",[s._v("Docker是由go语言开发的一个开源应用容器引擎")]),s._v(" "),a("p",[s._v("Docker可以让开发者打包应用程序到一个轻量级、可移植的容器中, 然后部署到任何系统上")])]),s._v(" "),a("p",[a("strong",[s._v("Docker是一种容器化平台，可以将应用程序及其依赖项打包到一个可移植的容器中，从而实现快速部署、可移植性和可伸缩性")])]),s._v(" "),a("h2",{attrs:{id:"为什么要使用docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么要使用docker"}},[s._v("#")]),s._v(" 为什么要使用Docker?")]),s._v(" "),a("blockquote",[a("p",[s._v("在Docker之前, n个开发人员就会有n个配置文件, 再部署环境时, 通常会有开发这边可以正常跑通, 而测试人员却说不行, 这就会出现环境不统一问题")]),s._v(" "),a("p",[s._v("当需要部署多台服务器时, 每台服务器单独配置环境太繁琐, 而且会出现环境不匹配问题")]),s._v(" "),a("p",[s._v("使用Docker之后, 这些问题都迎刃而解")])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(297),alt:"image-20231110162101499"}}),s._v(" "),a("p",[s._v("以Docker的角度来讲, 我们所部署的开发环境都可以打包为一个镜像文件, 在使用时 只需要拉取这个镜像文件即可")]),s._v(" "),a("h2",{attrs:{id:"优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优势"}},[s._v("#")]),s._v(" 优势")]),s._v(" "),a("ul",[a("li",[s._v("一次构建, 随处运行")]),s._v(" "),a("li",[s._v("更快速的应用交付和部署")]),s._v(" "),a("li",[s._v("更简单的系统运维")]),s._v(" "),a("li",[s._v("更便捷的系统升级和扩展")]),s._v(" "),a("li",[s._v("不用担心环境不统一问题")])]),s._v(" "),a("p",[a("strong",[s._v("docker只做三件事, 打包、发布、运行")])]),s._v(" "),a("h2",{attrs:{id:"docker相对于虚拟机的优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker相对于虚拟机的优势"}},[s._v("#")]),s._v(" Docker相对于虚拟机的优势")]),s._v(" "),a("ul",[a("li",[s._v("轻量级")]),s._v(" "),a("li",[s._v("启动快")]),s._v(" "),a("li",[s._v("资源占用少")])]),s._v(" "),a("p",[a("strong",[s._v("docker容器在操作系统层面实现虚拟化, 直接复用本地操作系统, 而传统虚拟机则是在硬件层面进行虚拟化, 与传统虚拟机相比, docker启动更快, 体积更小")])]),s._v(" "),a("h2",{attrs:{id:"基本组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本组成"}},[s._v("#")]),s._v(" 基本组成")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("镜像「images」")]),s._v(" "),a("blockquote",[a("p",[s._v("可以理解为是一个Linux的文件系统, 里面包含了可以运行在Linux内核的程序以及应用数据")])]),s._v(" "),a("p",[s._v("扩展一下Linux知识:")]),s._v(" "),a("blockquote",[a("p",[s._v("通常Linux分为两个部分, Linux内核和用户空间, 而真正的Linux系统指的其实就是Linux内核")]),s._v(" "),a("p",[s._v("常用的Ubuntu、CentOS等版本其实就是不同厂商在Linux内核的基础上扩展了自己的软件和工具所形成的版本")])]),s._v(" "),a("p",[a("strong",[s._v("因此我们可以将镜像看作是上面所讲的用户空间, 当docker通过镜像创建一个容器时, 就是将镜像定义好的用户空间作为独立隔离的进程运行在宿主机的Linux内核之上")])]),s._v(" "),a("ul",[a("li",[s._v("镜像是分层的, 一个镜像可以由多个中间层组成, 多个镜像可以共享同一中间层, 也可以通过在镜像中添加多一层来生成一个新镜像")]),s._v(" "),a("li",[s._v("镜像是"),a("strong",[s._v("只读")]),s._v("的, 镜像在构建完成之后就不可以在进行修改, 而上面所说的添加一层构建新镜像是指通过创建一个临时的容器, 在容器上进行文件的操作行为, 从而形成新的镜像, 而"),a("strong",[s._v("容器是可以动态改变的")])])])]),s._v(" "),a("li",[a("p",[s._v("容器「container」")]),s._v(" "),a("blockquote",[a("p",[s._v("容器与镜像的关系就如同Java中对象与类的关系")]),s._v(" "),a("p",[s._v("容器是通过镜像来创建的, 所以必须要有镜像才可以创建容器, 而生成的容器是独立于宿主机的隔离进程, 并且有属于自己的网络和命名空间")])]),s._v(" "),a("p",[a("strong",[s._v("镜像由多个中间层组成, 生成的镜像是只读的, 但容器却是可读写的, 这是因为容器是在镜像上面添加的一层读写层来实现的")])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(298),alt:"image-20231111134731464"}})]),s._v(" "),a("li",[a("p",[s._v("仓库「repository」")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("用来存储镜像的地方")]),s._v(" "),a("blockquote",[a("p",[s._v("仓库又分为公共仓库和私有仓库")]),s._v(" "),a("p",[s._v("公共仓库一般指DockerHub, 我们可以从公共仓库中获取镜像, 如: nginx、redis、mysql等, 也可以上传自己的镜像")]),s._v(" "),a("p",[s._v("私有仓库一般在团队内部需要共享镜像时, 但直接导出发给其他开发人员又比较麻烦, 因此可以搭建自己的私有仓库, 用于存储和发布自己的镜像")])])]),s._v(" "),a("li",[a("p",[s._v("https://hub.docker.com/")])]),s._v(" "),a("li",[a("p",[s._v("https://docker.mirrors.ustc.edu.cn/")])]),s._v(" "),a("li",[a("p",[s._v("阿里云")])]),s._v(" "),a("li",[a("p",[s._v("华为云")])]),s._v(" "),a("li",[a("p",[s._v("...")])])])])]),s._v(" "),a("blockquote",[a("p",[s._v("三个元素对应三个命令, build、ship、run")])]),s._v(" "),a("h2",{attrs:{id:"docker工作原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker工作原理"}},[s._v("#")]),s._v(" Docker工作原理")]),s._v(" "),a("blockquote",[a("p",[s._v("docker在运行容器时, 会先去本地查找镜像, 如果存在则直接运行, 否则会去远程仓库拉取镜像, 然后再去运行")]),s._v(" "),a("p",[s._v("这点在我们第一次运行hello-world时会体验")])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(299),alt:"image-20231115161438827"}}),s._v(" "),a("h2",{attrs:{id:"安装-ubuntu"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-ubuntu"}},[s._v("#")]),s._v(" 安装(Ubuntu)")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docker.p2hp.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("中文官网"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.docker.com/engine/install/centos/",target:"_blank",rel:"noopener noreferrer"}},[s._v("CentOS"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.docker.com/engine/install/ubuntu/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Ubuntu"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("==注意我们安装的是引擎「Engine」不是桌面程序「Desktop」==")]),s._v(" "),a("blockquote",[a("p",[s._v("如果您的机器上安装过docker, 请先按照官网步骤删除残留docker文件")])]),s._v(" "),a("h3",{attrs:{id:"更新软件包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新软件包"}},[s._v("#")]),s._v(" 更新软件包")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"安装docker依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装docker依赖"}},[s._v("#")]),s._v(" 安装docker依赖")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ca-certificates "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" gnupg lsb-release\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"添加官方gpg密钥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加官方gpg密钥"}},[s._v("#")]),s._v(" 添加官方GPG密钥")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 官方下载(可能会比较慢)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fsSL")]),s._v(" https://download.docker.com/linux/ubuntu/gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-key "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 阿里云镜像下载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fsSL")]),s._v(" http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-key "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"添加docker软件源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加docker软件源"}},[s._v("#")]),s._v(" 添加docker软件源")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" add-apt-repository "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu '),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("lsb_release "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-cs")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(' stable"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装docker"}},[s._v("#")]),s._v(" 安装docker")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"配置用户组-可选"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置用户组-可选"}},[s._v("#")]),s._v(" 配置用户组(可选)")]),s._v(" "),a("blockquote",[a("p",[s._v("默认情况下只有root用户和docker组的用户才能使用docker命令, 我们可以将当前用户添加到docker组")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("需要重新登录才能生效")])]),s._v(" "),a("h3",{attrs:{id:"验证docker引擎是否安装成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证docker引擎是否安装成功"}},[s._v("#")]),s._v(" 验证docker引擎是否安装成功")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看docker版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(300),alt:"image-20231115161023803"}}),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行hello-world")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run hello-world\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(301),alt:"image-20231115160338325"}}),s._v(" "),a("blockquote",[a("p",[s._v("很欣慰, 在安装时很给力, 一路绿灯😎")])]),s._v(" "),a("h2",{attrs:{id:"安装完成后就卸载吧-不怀好意的笑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装完成后就卸载吧-不怀好意的笑"}},[s._v("#")]),s._v(" 安装完成后就卸载吧~(不怀好意的笑)")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" purge docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin docker-ce-rootless-extras\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/containerd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"镜像加速"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像加速"}},[s._v("#")]),s._v(" 镜像加速")]),s._v(" "),a("blockquote",[a("p",[s._v("镜像源可以有多个选择, 比如阿里云、华为云、网易云等")]),s._v(" "),a("p",[s._v("这里以**==华为云==**做例")])]),s._v(" "),a("p",[s._v("在选择好镜像厂家后, 需要先进行"),a("strong",[s._v("登录")]),s._v(", 然后在"),a("strong",[s._v("产品区域")]),s._v("找到"),a("strong",[s._v("镜像加速服务/容器镜像服务")])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(302),alt:"image-20231115162431186"}}),s._v(" "),a("p",[s._v("复制加速器地址并进行配置")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入/etc/docker目录下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/docker/daemon.json\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加以下内容")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirror-url"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("blockquote",[a("p",[s._v("输入"),a("code",[s._v("sudo docker info")]),s._v("查看镜像仓库是否配置成功")])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(303),alt:"image-20231115163918931"}}),s._v(" "),a("p",[a("strong",[s._v("如果配置失败, 检查其他目录(/etc/sysconfig/docker、/etc/default/docker)中是否配置了"),a("code",[s._v("registry-mirros")]),s._v("参数")])]),s._v(" "),a("h2",{attrs:{id:"分析hello-world"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分析hello-world"}},[s._v("#")]),s._v(" 分析hello-world")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("run hello-world")]),s._v("做了什么事")])]),s._v(" "),a("blockquote",[a("p",[s._v("首先docker会在本地查找hello-world镜像, 如果本地存在则直接以该镜像为模板生产容器实例并运行")]),s._v(" "),a("p",[s._v("不存在则会去镜像仓库中去查找hello-world, 如果能找到, 将hello-world拉取到本地并生产容器实例运行")]),s._v(" "),a("p",[s._v("否则返回失败错误, 找不到hello-world")])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(304),alt:"image-20231115165537935"}}),s._v(" "),a("h2",{attrs:{id:"docker为什么比虚拟机快"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker为什么比虚拟机快"}},[s._v("#")]),s._v(" Docker为什么比虚拟机快?")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("docker有更少的抽象层")]),s._v(" "),a("p",[s._v("虚拟机加载的"),a("code",[s._v("iso")]),s._v("文件包含了软件、硬件、驱动等等, 不管用不用的到, 都会去进行加载, 而docker不会, docker容器上的程序直接使用实际物理机的硬件资源, 因此在CPU以及内存利用率上有明显的优势")])]),s._v(" "),a("li",[a("p",[s._v("docker利用的是宿主机的内核, 不需要重新加载操作系统OS内核")]),s._v(" "),a("p",[s._v("当新建一个容器时, docker不需要像虚拟机一样重新加载一个操作系统内核, 进而避免了引导、加载操作系统内核的时间")])])]),s._v(" "),a("h2",{attrs:{id:"docker命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker命令"}},[s._v("#")]),s._v(" Docker命令")]),s._v(" "),a("h3",{attrs:{id:"service-docker-start"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service-docker-start"}},[s._v("#")]),s._v(" "),a("code",[s._v("service docker start")])]),s._v(" "),a("blockquote",[a("p",[s._v("启动docker")])]),s._v(" "),a("h3",{attrs:{id:"service-docker-restart"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service-docker-restart"}},[s._v("#")]),s._v(" "),a("code",[s._v("service docker restart")])]),s._v(" "),a("blockquote",[a("p",[s._v("重启docker")])]),s._v(" "),a("h3",{attrs:{id:"service-docker-stop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service-docker-stop"}},[s._v("#")]),s._v(" "),a("code",[s._v("service docker stop")])]),s._v(" "),a("blockquote",[a("p",[s._v("停止docker")])]),s._v(" "),a("h3",{attrs:{id:"service-docker-status"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service-docker-status"}},[s._v("#")]),s._v(" "),a("code",[s._v("service docker status")])]),s._v(" "),a("blockquote",[a("p",[s._v("查看docker运行状态")])]),s._v(" "),a("h3",{attrs:{id:"systemctl-enable-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#systemctl-enable-docker"}},[s._v("#")]),s._v(" "),a("code",[s._v("systemctl enable docker")])]),s._v(" "),a("blockquote",[a("p",[s._v("设置开机自启")])]),s._v(" "),a("h3",{attrs:{id:"docker-info"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-info"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker info")])]),s._v(" "),a("blockquote",[a("p",[s._v("查看docker信息")])]),s._v(" "),a("h3",{attrs:{id:"docker-help"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-help"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker --help")])]),s._v(" "),a("blockquote",[a("p",[s._v("查看docker帮助文档")])]),s._v(" "),a("h3",{attrs:{id:"docker-命令-help"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-命令-help"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker [命令] --help")])]),s._v(" "),a("blockquote",[a("p",[s._v("查看相关命令帮助文档")])]),s._v(" "),a("h3",{attrs:{id:"docker-images"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-images"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker images")])]),s._v(" "),a("blockquote",[a("p",[s._v("查看本地所有镜像")]),s._v(" "),a("p",[a("code",[s._v("docker image ls")])])]),s._v(" "),a("ul",[a("li",[a("code",[s._v("-a")]),s._v("查看本地所有镜像")]),s._v(" "),a("li",[a("code",[s._v("-q")]),s._v("只查看镜像ID")])]),s._v(" "),a("h3",{attrs:{id:"docker-search-images"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-search-images"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker search [images]")])]),s._v(" "),a("blockquote",[a("p",[s._v("查询某个镜像")])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(305),alt:"image-20231118142340774"}}),s._v(" "),a("p",[a("strong",[s._v("OFFICIAL的值为"),a("code",[s._v("OK")]),s._v("表示该镜像为官方认证")])]),s._v(" "),a("ul",[a("li",[a("code",[s._v("--limit <num>")]),s._v("只显示<num>个镜像")])]),s._v(" "),a("h3",{attrs:{id:"docker-pull-images"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-pull-images"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker pull [images]")])]),s._v(" "),a("blockquote",[a("p",[s._v("拉取某个镜像")])]),s._v(" "),a("ul",[a("li",[a("code",[s._v("docker pull [images]:TAG")]),s._v("指定镜像的版本, 不加"),a("code",[s._v(":TAG")]),s._v("默认为最新版, 等价于"),a("code",[s._v("docker pull [images]:latest")])])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(306),alt:"image-20231118143715975"}}),s._v(" "),a("h3",{attrs:{id:"给镜像设置别名-打标签"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#给镜像设置别名-打标签"}},[s._v("#")]),s._v(" 给镜像设置别名/打标签")]),s._v(" "),a("blockquote",[a("p",[s._v("docker不能直接给镜像设置别名, 但可以通过设置标签来达到设置别名的目的")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image_id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("repository"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("tag"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# image_id:    要打标签的镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# repository:  仓库名称<这个玩意通常不用指定>")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tag: \t\t   别名")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# example")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag 967ca3be8ed4 mynginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后就可以使用这个名字创建容器了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". mynginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(307),alt:"image-20240423163634328"}}),s._v(" "),a("p",[s._v("执行"),a("code",[s._v("docker images")]),s._v("会发现多了一个镜像")]),s._v(" "),a("p",[s._v("那么是不是可以认为执行"),a("code",[s._v("docker tag")]),s._v("命令后, 会复制已有的镜像取个别名或者软链接之类的???")]),s._v(" "),a("p",[s._v("==执行"),a("code",[s._v("tag")]),s._v("命令没有复制也没有创建额外的文件, 而是创建一个标签映射, 多个标签可以指向同一个镜像, 因此, "),a("code",[s._v("docker tag")]),s._v("命令创建的标签不会导致额外的空间消耗==")]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(308),alt:"image-20240423164301885"}}),s._v(" "),a("p",[s._v("它们两个的镜像ID都是一样的, 所以只是指向, "),a("s",[s._v("有点软链接的意思")])]),s._v(" "),a("p",[s._v("删除源镜像时, 会提示有引用无法删除, 必须强制删除")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Error response from daemon: conflict: unable to delete 7614ae9453d1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("must be forced"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" - image is referenced "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" multiple repositories\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("先删除tag别名镜像, 然后再删除源镜像")]),s._v(" "),a("h3",{attrs:{id:"docker-system-df"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-system-df"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker system df")])]),s._v(" "),a("blockquote",[a("p",[s._v("查看镜像容器所占空间")])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(309),alt:"image-20231118144403185"}}),s._v(" "),a("h3",{attrs:{id:"docker-rmi-镜像名称-镜像id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-rmi-镜像名称-镜像id"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker rmi [镜像名称|镜像ID]")])]),s._v(" "),a("blockquote",[a("p",[s._v("删除指定镜像")]),s._v(" "),a("p",[s._v("在删除前需要先停止引用容器")])]),s._v(" "),a("ul",[a("li",[a("code",[s._v("-f")]),s._v("强制删除")]),s._v(" "),a("li",[a("code",[s._v("docker rmi <image> <image>")]),s._v("一次删除多个镜像, 镜像名或镜像ID用"),a("strong",[s._v("空格")]),s._v("隔开")]),s._v(" "),a("li",[a("code",[s._v("docker rmi $(docker images -qa)")]),s._v("删除全部镜像, docker命令是支持参数续传的, 一般会加"),a("code",[s._v("-f")]),s._v("一起使用")])]),s._v(" "),a("h3",{attrs:{id:"什么是docker虚悬镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是docker虚悬镜像"}},[s._v("#")]),s._v(" 什么是docker虚悬镜像?")]),s._v(" "),a("blockquote",[a("p",[s._v("虚悬镜像是指docker镜像的仓库名、镜像名、标签都为<none>的镜像")])]),s._v(" "),a("p",[s._v("指那些不在与任何容器相关联的镜像, 这些镜像的产生可能是因为构建的版本或镜像删除不彻底所留下的")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以通过此命令查看虚悬镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dangling")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("可以使用"),a("code",[s._v("docker image prune")]),s._v("清理残留镜像")]),s._v(" "),a("p",[s._v("=="),a("strong",[s._v("对于容器, 此命令会将已停止的容器删除, 因此为了防止数据的丢失, 即时做好备份")]),s._v("==")]),s._v(" "),a("h3",{attrs:{id:"docker-run-options-image"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-run-options-image"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker run [options] image")])]),s._v(" "),a("blockquote",[a("p",[s._v("创建并启动一个镜像")])]),s._v(" "),a("p",[s._v("这个命令在运行时会先去本地查找, 找不到再去仓库拉取")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("options: --name")]),s._v("为容器指定一个新名称")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("options: -d")]),s._v("启动守护式容器, 也是后台启动, 启动成功会返回容器ID")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("options: -i")]),s._v("以交互模式运行容器")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("options: -t")]),s._v("为容器重新分配一个伪输入终端, 通常<i>和<t>一起使用")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("options: -P")]),s._v("随机端口映射")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("options: -p")]),s._v("指定端口映射")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("options: --rm")]),s._v("容器停止后, 自动删除")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),s._v(" "),a("th",{staticStyle:{"text-align":"left"}},[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("-p hostPort:containerPort")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("端口映射 -p 8080:80")])])])])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# example")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mynginx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 nginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# example")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" nginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行nginx容器且映射端口80 当容器停止后, 自动删除容器实例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 还有一个要注意的点, 如果容器不指定版本则默认会找latest版本, 而你又没有安装latest版, 所以极大概率会Unable to find image 'nginx:latest' locally错误!!!")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(310),alt:"image-20240423150640835"}}),s._v(" "),a("h3",{attrs:{id:"docker-ps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-ps"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker ps")])]),s._v(" "),a("blockquote",[a("p",[s._v("查看当前运行的容器")]),s._v(" "),a("p",[a("strong",[s._v("-a")]),s._v(" 查看所有容器包含已停止容器")])]),s._v(" "),a("h3",{attrs:{id:"docker-start-容器名称-id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-start-容器名称-id"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker start [容器名称|ID]")])]),s._v(" "),a("blockquote",[a("p",[s._v("启动容器")])]),s._v(" "),a("h3",{attrs:{id:"docker-restart"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-restart"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker restart ...")])]),s._v(" "),a("blockquote",[a("p",[s._v("重启容器")])]),s._v(" "),a("h3",{attrs:{id:"docker-stop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-stop"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker stop ...")])]),s._v(" "),a("blockquote",[a("p",[s._v("停止容器")])]),s._v(" "),a("h3",{attrs:{id:"docker-kill"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-kill"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker kill ...")])]),s._v(" "),a("blockquote",[a("p",[s._v("杀死容器|强制停止容器")])]),s._v(" "),a("h3",{attrs:{id:"docker-rm-容器id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-rm-容器id"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker rm [容器ID]")])]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("docker rm -f $(docker ps -qa)")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("docker ps -qa | xargs docker rm")]),s._v("同上删除多个容器")]),s._v(" "),a("p",[s._v("xargs: 将上一个命令的输出作为下一个命令的参数")]),s._v(" "),a("p",[s._v("-f: 强制删除")])])]),s._v(" "),a("h3",{attrs:{id:"docker-logs-容器id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-logs-容器id"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker logs [容器ID]")])]),s._v(" "),a("blockquote",[a("p",[s._v("查看容器日志")])]),s._v(" "),a("h3",{attrs:{id:"docker-top-容器id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-top-容器id"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker top [容器ID]")])]),s._v(" "),a("blockquote",[a("p",[s._v("查看容器实例信息")])]),s._v(" "),a("h3",{attrs:{id:"docker-inspect-container-id-or-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-inspect-container-id-or-name"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker inspect [container_id_or_name]")])]),s._v(" "),a("blockquote",[a("p",[s._v("查看容器实例详细信息")])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(311),alt:"image-20231118185524246"}}),s._v(" "),a("h3",{attrs:{id:"docker-exec-it-容器id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-exec-it-容器id"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker exec -it [容器ID]")])]),s._v(" "),a("blockquote",[a("p",[s._v("进入指定容器")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" container "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# options:   可选命令参数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container: 容器名称或ID")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# command:   要在容器中执行的指令")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# arg:\t\t command所附带的指令参数")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个命令通常这么使用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" container /bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("code",[s._v("docker exec")]),s._v("需要至少两个参数才可以执行")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" nginx\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker exec"')]),s._v(" requires at least "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" arguments.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -it 不算参数, 所以需要指定bash路径   docker exec -it nginx /bin/bash")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"docker-attach-容器id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-attach-容器id"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker attach [容器ID]")])]),s._v(" "),a("blockquote",[a("p",[s._v("同上")])]),s._v(" "),a("p",[a("strong",[s._v("不同的是: attach进入容器不会启动新的进程, 执行"),a("code",[s._v("exit")]),s._v("命令后会停止容器, 而使用exec进入容器会启动新的进程, 执行"),a("code",[s._v("exit")]),s._v("命令后容器不会停止")])]),s._v(" "),a("p",[s._v("==进入容器后, 可以使用"),a("code",[s._v("ctrl")]),s._v("+"),a("code",[s._v("p")]),s._v("+"),a("code",[s._v("q")]),s._v("退出==")]),s._v(" "),a("h2",{attrs:{id:"镜像和容器的关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像和容器的关系"}},[s._v("#")]),s._v(" 镜像和容器的关系?")]),s._v(" "),a("blockquote",[a("p",[s._v("容器是镜像的实例, 是基于镜像而创建的实例")])]),s._v(" "),a("p",[s._v("以Java角度来讲, 镜像就是类Class, 而容器就是类的对象实例")]),s._v(" "),a("p",[s._v("镜像: 一个只读的文件系统快照, 包含运行容器所需要的所有内容, 是容器的基础, 可以看做是容器的蓝图或模板")]),s._v(" "),a("p",[s._v("容器: 基于镜像而创建的实例, 启动容器时, Docker会基于指定的镜像创建一个新的容器实例并在其上运行指定的命令, 容器可以被启动、停止、删除等操作, 它是一个独立的运行环境, 拥有自己的一套东西, 比如: 文件系统、网络环境、进程空间等.")]),s._v(" "),a("h3",{attrs:{id:"docker-network-ls"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-network-ls"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker network ls")])]),s._v(" "),a("blockquote",[a("p",[s._v("列出所有网络")])]),s._v(" "),a("h3",{attrs:{id:"docker-network-create-network-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-network-create-network-name"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker network create <network_name>")])]),s._v(" "),a("blockquote",[a("p",[s._v("创建一个新的网络")])]),s._v(" "),a("h2",{attrs:{id:"docker网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker网络"}},[s._v("#")]),s._v(" Docker网络?")]),s._v(" "),a("blockquote",[a("p",[s._v("一个虚拟的网络, 可以让多个docker容器相互通信交互")])]),s._v(" "),a("p",[s._v("使用docker网络可以实现以下目的")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("隔离容器")]),s._v(" "),a("p",[s._v("每一个docker网络都一个独立隔离的网络环境, 不同网络之间无法直接通信, 除非进行网络连接")])]),s._v(" "),a("li",[a("p",[s._v("容器通信")]),s._v(" "),a("p",[s._v("将容器连接到同一个网络下, 可以使容器间相互通信, 而不需要将端口暴露到主机上")])]),s._v(" "),a("li",[a("p",[s._v("跨主机通信")])])]),s._v(" "),a("h3",{attrs:{id:"docker-network-connect-network-name-container-id-or-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-network-connect-network-name-container-id-or-name"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker network connect <network_name> <container_id_or_name>")])]),s._v(" "),a("blockquote",[a("p",[s._v("指定容器连接指定网络")]),s._v(" "),a("p",[a("code",[s._v("disconnect")]),s._v(": 断开连接")])]),s._v(" "),a("h2",{attrs:{id:"文件拷贝"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件拷贝"}},[s._v("#")]),s._v(" 文件拷贝")]),s._v(" "),a("blockquote",[a("p",[s._v("容器内文件备份到主机")])]),s._v(" "),a("p",[a("code",[s._v("docker cp <container_id>:<path> <path>")])]),s._v(" "),a("p",[s._v("container_id: 容器ID")]),s._v(" "),a("p",[s._v("第一个path:   容器内文件的路径<可以是一个目录>")]),s._v(" "),a("p",[s._v("第二个path:   目标路径")]),s._v(" "),a("h2",{attrs:{id:"导出容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导出容器"}},[s._v("#")]),s._v(" 导出容器")]),s._v(" "),a("blockquote",[a("p",[s._v("这个操作可以让我们的容器在不同环境下运行且可以共享容器")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("container_id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".tar\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个操作可以直接备份整个容器")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"导入容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导入容器"}},[s._v("#")]),s._v(" 导入容器")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".tar "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("repository"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("tag"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果不指定仓库, 就会出现虚悬镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在启动时, 需要使用docker run -it <image_id> /bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 因为它是个容器所以不能单纯使用run命令")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"docker镜像层都是只读的-容器层是可写的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker镜像层都是只读的-容器层是可写的"}},[s._v("#")]),s._v(" Docker镜像层都是只读的, 容器层是可写的")]),s._v(" "),a("blockquote",[a("p",[s._v("docker在启动时, 一个最新的可写层被加载到镜像的最顶层, "),a("strong",[s._v("这一层通常被称为容器层, 容器层之下的都是镜像层")])])]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(312),alt:"image-20240430165415446"}}),s._v(" "),a("p",[a("strong",[s._v("所有对容器的操作, 不管是添加、删除、修改文件等都只是发生在容器层中, 只有容器是可写的, 容器层之下镜像层都是只读的")])]),s._v(" "),a("p",[a("strong",[s._v("拓展:")]),s._v("==bootfs是docker镜像中最底层的文件系统, 通常情况下该文件是只读的, 类似于一个基本的linux发行版, 这个文件系统包含了最基本的系统文件和目录, 例如:/bin/sbin/lib等 bootfs是docker镜像的基础, 上层的层叠文件系统在其之上进行构建, 从而实现镜像的分层和可修改性==")]),s._v(" "),a("h2",{attrs:{id:"docker-commit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-commit"}},[s._v("#")]),s._v(" "),a("code",[s._v("docker commit")])]),s._v(" "),a("blockquote",[a("p",[s._v("以当前镜像为基础保存为一个新的镜像")])]),s._v(" "),a("p",[s._v("比如, 我们拉取了一个新的ubuntu镜像, 但这个镜像没有vim命令, 我们就可以安装一个vim依赖, 并将含有vim命令的镜像发布为一个新的镜像, 这样在拉取新ubuntu镜像时, 就含有vim命令了")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" container "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("repository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container:  要保存为镜像的已运行状态的容器名称或ID")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# repository: 要创建的新镜像名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tag:\t\t  镜像标签, 可选")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("拉取centos镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull centos:7\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置别名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag eeb6ee3f44bd mylinux\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行容器并执行vim命令")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" mylinux /bin/bash\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@b5bcf936781c /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim test.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后就会出现找不到vim")]),s._v("\nbash: vim: "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" not found\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装vim")]),s._v("\nyum update "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后再使用vim命令已经可以正常使用了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 接下来, 以安装vim命令的centos镜像为基础, commit一个新的centos镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"naihe"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"add vim"')]),s._v(" mycentos havevimcentos\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后运行这个容器并执行vim命令, 然后就会发现在新的镜像中没有安装vim命令也可以使用vim了")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("==通常不会这么去做, 一般采用"),a("code",[s._v("Dockerfile")]),s._v("文件构建镜像==")]),s._v(" "),a("h2",{attrs:{id:"docker推送镜像到私服"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker推送镜像到私服"}},[s._v("#")]),s._v(" docker推送镜像到私服")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载registry")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull registry\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行私服")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v(":5000 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /naihe/myregistry/:/tmp/registry "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true registry\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看私服镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XGET")]),s._v(" http://localhost:5000/v2/_catalog\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repositories"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 刚开始结果肯定为空, 因为还没有上传私服镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上传私服镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag 967ca3be8ed4 localhost:5000/nginx\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push localhost:5000/nginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这时查看私服镜像已经有nginx镜像了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XGET")]),s._v(" http://localhost:5000/v2/_catalog\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repositories"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拉取私服nginx镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull localhost:5000/nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"docker容器数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker容器数据"}},[s._v("#")]),s._v(" docker容器数据")]),s._v(" "),a("blockquote",[a("p",[s._v("Docker提供的一种数据持久化存储机制, 用于在容器和宿主机之前进行数据共享, 并且可以在==容器删除后保留数据==")]),s._v(" "),a("p",[s._v("对文件的修改都是相互的, 在宿主机上所做的修改会同步到容器中, 反之也是一样")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("宿主机目录"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器目录"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ImageID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("以nginx为例")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mynginx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_nginx/html:/data/html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_nginx/logs:/data/logs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_nginx/nginx.conf:/etc/nginx/nginx.conf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true mynginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("可以通过"),a("code",[s._v("docker inspect <container>")]),s._v("来查看是否挂载成功")]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:t(313),alt:"image-20240501102511216"}}),s._v(" "),a("p",[a("strong",[s._v("如果修改文件后没有生效, 重启容器就好"),a("code",[s._v("docker restart mynginx")])])]),s._v(" "),a("div",{staticClass:"language-nginx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx不允许location /配置块使用相对路径的root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v(" example.com")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v(" /var/www")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v(" /var/www/images")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要么不写, 要么写绝对路径")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将会使用 /var/www/images 作为根目录")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /./image/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v(" images")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将会使用 /var/www/images 作为根目录")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h3",{attrs:{id:"可以通过ro或rw指定容器对数据卷的权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可以通过ro或rw指定容器对数据卷的权限"}},[s._v("#")]),s._v(" 可以通过ro或rw指定容器对数据卷的权限")]),s._v(" "),a("ul",[a("li",[s._v("rw: 可读可写")]),s._v(" "),a("li",[s._v("ro: 只读")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_nginx/html:/data/html:ro mynginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 也可以使用--mount命令")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--mount")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bind,source"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/naihe/docker_nginx/html,target"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/data/html,readonly"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true mynginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"数据卷之间的继承和共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷之间的继承和共享"}},[s._v("#")]),s._v(" 数据卷之间的继承和共享")]),s._v(" "),a("blockquote",[a("p",[s._v("可以让一个容器共享另一个容器的数据")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true --volumes-from mynginx1 mynginx2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("假设mynginx1停止了, 是不影响mynginx2的, 在mynginx2中修改文件依旧可以同步到宿主机上\n这时mynginx1启动, 是可以同步mynginx2的修改\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"docker安装mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker安装mysql"}},[s._v("#")]),s._v(" docker安装mysql")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 mysql\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看一下mysql的编码")]),s._v("\nshow variables like "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'character%'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果不是utf8, 在插入中文数据时会有编码错误")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 一般来讲mysql8不会有这个问题, 5版本出现的几率比较大")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 持久化mysql数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_mysql/data:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_mysql/log:/var/log/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_mysql/conf/mysql.conf:/etc/mysql/conf.d/mysql.conf mysql\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置文件不能出错 不然启动失败")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h2",{attrs:{id:"docker安装redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker安装redis"}},[s._v("#")]),s._v(" docker安装redis")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull redis:6\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动redis")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" myredis "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_redis/data:/data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_redis/conf/redis.conf:/etc/redis/redis.conf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true myredis redis-server /etc/redis/redis.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"docker安装mongodb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker安装mongodb"}},[s._v("#")]),s._v(" docker安装mongodb")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mongo\n/data/db\n/var/log/mongodb\n/etc/mongod.conf\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mongodb "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27017")]),s._v(":27017 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_mongo/data:/data/db "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_mongo/config/mongod.conf:/etc/mongod.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/naihe/docker_mongo/log:/var/log/mongodb "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true dfda7a2cf273 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--auth")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"docker部署springboot应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker部署springboot应用"}},[s._v("#")]),s._v(" docker部署SpringBoot应用")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("FROM openjdk:11-jre-slim\n\nCOPY my-site.jar app.jar\n\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),s._v("\n\nENTRYPOINT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-jar"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"app.jar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" Dockerfile")]),s._v(" "),a("blockquote",[a("p",[s._v("构建docker镜像的文件")]),s._v(" "),a("p",[s._v("只是构建")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.docker.com/reference/dockerfile",target:"_blank",rel:"noopener noreferrer"}},[s._v("构建参数"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"docker执行dockerfile的流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker执行dockerfile的流程"}},[s._v("#")]),s._v(" docker执行Dockerfile的流程")]),s._v(" "),a("ul",[a("li",[s._v("docker从基础镜像运行一个容器")]),s._v(" "),a("li",[s._v("执行相关指令对容器做出修改")]),s._v(" "),a("li",[s._v("执行类似commit的操作提交一个新的镜像层")]),s._v(" "),a("li",[s._v("基础新的镜像运行一个容器")]),s._v(" "),a("li",[s._v("执行Dockerfile下一条指令直到所有的指令运行完成")])]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不区分大小写")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用官方 Nginx 镜像作为基础镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" nginx:1.24.0")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将本地的 Nginx 配置文件复制到容器内的 /etc/nginx/ 目录下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" nginx.conf /etc/nginx/nginx.conf")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复制静态网页文件到 Nginx 默认的网页目录 /usr/share/nginx/html/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" ./html /usr/share/nginx/html/")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露 Nginx 监听的端口（默认为 80）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 80")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定容器启动时运行的命令，启动 Nginx 服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-g"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"daemon off;"')]),s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" myblog "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 myblog\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);