<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Spring Boot | Study Notes</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/study/logo.svg">
    <meta name="description" content="">
    
    <link rel="preload" href="/study/assets/css/0.styles.7d302c8d.css" as="style"><link rel="preload" href="/study/assets/js/app.6d3630f5.js" as="script"><link rel="preload" href="/study/assets/js/2.40365491.js" as="script"><link rel="preload" href="/study/assets/js/1.eec64618.js" as="script"><link rel="preload" href="/study/assets/js/15.04415536.js" as="script"><link rel="prefetch" href="/study/assets/js/10.bfd158aa.js"><link rel="prefetch" href="/study/assets/js/11.ee769b27.js"><link rel="prefetch" href="/study/assets/js/12.c5502306.js"><link rel="prefetch" href="/study/assets/js/13.772ba8b8.js"><link rel="prefetch" href="/study/assets/js/14.eb7a6da8.js"><link rel="prefetch" href="/study/assets/js/16.b81b8892.js"><link rel="prefetch" href="/study/assets/js/17.faf137c3.js"><link rel="prefetch" href="/study/assets/js/18.ba9636f0.js"><link rel="prefetch" href="/study/assets/js/19.2a36490d.js"><link rel="prefetch" href="/study/assets/js/20.cb0fe819.js"><link rel="prefetch" href="/study/assets/js/21.fdfe156a.js"><link rel="prefetch" href="/study/assets/js/22.aaf6fed9.js"><link rel="prefetch" href="/study/assets/js/23.fc8322ab.js"><link rel="prefetch" href="/study/assets/js/24.bfc40fb7.js"><link rel="prefetch" href="/study/assets/js/25.688b920d.js"><link rel="prefetch" href="/study/assets/js/26.9b302a72.js"><link rel="prefetch" href="/study/assets/js/27.0ba8ed8f.js"><link rel="prefetch" href="/study/assets/js/28.48655c0b.js"><link rel="prefetch" href="/study/assets/js/29.6726a437.js"><link rel="prefetch" href="/study/assets/js/3.e37420f1.js"><link rel="prefetch" href="/study/assets/js/30.185b360a.js"><link rel="prefetch" href="/study/assets/js/31.dfbef273.js"><link rel="prefetch" href="/study/assets/js/32.1382e380.js"><link rel="prefetch" href="/study/assets/js/33.5e7d748d.js"><link rel="prefetch" href="/study/assets/js/34.fde6461c.js"><link rel="prefetch" href="/study/assets/js/35.ca6fc384.js"><link rel="prefetch" href="/study/assets/js/36.29151333.js"><link rel="prefetch" href="/study/assets/js/37.6504d9c5.js"><link rel="prefetch" href="/study/assets/js/4.26fde88e.js"><link rel="prefetch" href="/study/assets/js/5.5e14a162.js"><link rel="prefetch" href="/study/assets/js/6.a5c47722.js"><link rel="prefetch" href="/study/assets/js/7.d769642e.js"><link rel="prefetch" href="/study/assets/js/vendors~docsearch.ca4cd80d.js">
    <link rel="stylesheet" href="/study/assets/css/0.styles.7d302c8d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/study/" class="home-link router-link-active"><img src="/study/logo.svg" alt="Study Notes" class="logo"> <span class="site-name can-hide">Study Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/study/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/study/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/study/spring/" class="nav-link">
  Spring
</a></div><div class="nav-item"><a href="/study/springboot/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  SpringBoot
</a></div><div class="nav-item"><a href="/study/es/" class="nav-link">
  Elasticsearch
</a></div><div class="nav-item"><a href="/study/docker/" class="nav-link">
  Docker
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><span class="title">More</span> <span class="arrow down"></span></button> <button type="button" aria-label="More" class="mobile-dropdown-title"><span class="title">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/study/mybatisplus/" class="nav-link">
  MybatisPlus
</a></li><li class="dropdown-item"><!----> <a href="/study/springcloudgateway/" class="nav-link">
  SpringCloudGateway
</a></li><li class="dropdown-item"><!----> <a href="/study/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/study/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/study/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/study/nodejs/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/study/jvm/" class="nav-link">
  Jvm
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/study/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/study/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/study/spring/" class="nav-link">
  Spring
</a></div><div class="nav-item"><a href="/study/springboot/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  SpringBoot
</a></div><div class="nav-item"><a href="/study/es/" class="nav-link">
  Elasticsearch
</a></div><div class="nav-item"><a href="/study/docker/" class="nav-link">
  Docker
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><span class="title">More</span> <span class="arrow down"></span></button> <button type="button" aria-label="More" class="mobile-dropdown-title"><span class="title">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/study/mybatisplus/" class="nav-link">
  MybatisPlus
</a></li><li class="dropdown-item"><!----> <a href="/study/springcloudgateway/" class="nav-link">
  SpringCloudGateway
</a></li><li class="dropdown-item"><!----> <a href="/study/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/study/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/study/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/study/nodejs/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/study/jvm/" class="nav-link">
  Jvm
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Spring Boot</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study/springboot/#什么是spring-boot" class="sidebar-link">什么是Spring Boot</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#什么是微服务" class="sidebar-link">什么是微服务</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#第一个spring-boot-程序" class="sidebar-link">第一个Spring Boot 程序</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#原理" class="sidebar-link">原理</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#yaml" class="sidebar-link">yaml</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#配置文件优先级" class="sidebar-link">配置文件优先级</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#静态资源" class="sidebar-link">静态资源</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#jsr-数据校验" class="sidebar-link">JSR 数据校验</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#多环境配置" class="sidebar-link">多环境配置</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#自动配置原理" class="sidebar-link">自动配置原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/springboot/#配置文件到底能写什么" class="sidebar-link">配置文件到底能写什么？</a></li></ul></li><li><a href="/study/springboot/#web" class="sidebar-link">Web</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/springboot/#模板引擎-thymeleaf" class="sidebar-link">模板引擎(thymeleaf)</a></li></ul></li><li><a href="/study/springboot/#spring-mvc-自动配置扩展" class="sidebar-link">Spring MVC 自动配置扩展</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#整合jdbc" class="sidebar-link">整合JDBC</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#druid" class="sidebar-link">Druid</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/springboot/#使用druid" class="sidebar-link">使用Druid</a></li></ul></li><li><a href="/study/springboot/#整合mybatis" class="sidebar-link">整合Mybatis</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#spring-security" class="sidebar-link">Spring Security</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/springboot/#shiro" class="sidebar-link">Shiro</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="spring-boot"><a href="#spring-boot" class="header-anchor">#</a> Spring Boot</h1> <blockquote><p>开发一个Web应用，从最初接触的Servlet结合Tomcat，到使用框架Struts，再后来使用Spring MVC，再到现在学习的Spring Boot</p> <blockquote><p>技术是不断更新的 所以我们要不断学习！</p></blockquote> <blockquote><p>Spring Boot 就是一个JavaWeb的开发框架，和Spring MVC类似 对比其他框架的好处，简化开发，约定大于配置，可以迅速开发Web应用</p></blockquote></blockquote> <h2 id="什么是spring-boot"><a href="#什么是spring-boot" class="header-anchor">#</a> 什么是Spring Boot</h2> <blockquote><p>Spring Boot 就是一个JavaWeb的开发框架，和Spring MVC类似 对比其他框架的好处，简化开发，约定大于配置，可以迅速开发Web应用</p></blockquote> <blockquote><p>Spring Boot基于Spring开发，它本身不提供Spring框架的核心特性以及扩展功能，只用于快速、敏捷地开发新一代基于Spring框架的应用程序</p> <p>它不是用来替代Spring的解决方案 而是和Spring框架紧密结合 用于提升Spring开发者体验的工具</p> <p>Spring Boot以约定大于配置的核心思想 默认帮我们进行了很多设置，多数Spring Boot应用只需要很少的Spring配置</p> <p>集成了大量常用的第三方库配置</p> <p>零配置开箱即用</p></blockquote> <blockquote><p>Spring Boot并不是什么新框架 它默认配置了很多框架的使用方式，就像maven整合了所有的 jar 包，spring boot 整合了所有的框架</p></blockquote> <p><strong>Spring Boot 的主要优点</strong></p> <ul><li>为所有Spring开发者更快的入门</li> <li><strong>开箱即用</strong>，提供各种默认配置来简化项目配置</li> <li>内嵌式容器简化Web项目</li> <li>没有冗余代码生成和XML配置的要求</li></ul> <p><strong>Spring Boot 缺点</strong></p> <ul><li>版本帝，迭代快</li> <li>封装深，不易精通</li></ul> <h2 id="什么是微服务"><a href="#什么是微服务" class="header-anchor">#</a> 什么是微服务</h2> <blockquote><p>微服务是一种架构风格，它要求我们在开发一个应用的时候，这个应用必须构成一系列小服务的组合；</p> <p>可以通过http的方式进行互通</p></blockquote> <p>学习微服务 先了解了解单体应用架构</p> <blockquote><p>单体应用架构</p></blockquote> <p><em>所谓单体应用架构是指：我们将一个应用中的所有应用服务都封装在一个应用中</em></p> <p><em>无论是ERP、CRM或者其他系统，都把数据库访问，web访问等各个功能都放在一个war包内</em></p> <p>好处：</p> <ul><li>易于开发和测试</li> <li>方便部署；需要扩展时 只需要将war复制多份，然后放到多个服务器上，再做个负载均衡就OK了</li></ul> <p>缺点：</p> <ul><li>在修改时，哪怕修改一个很小的地方，我们都需要停掉整个服务，重新打包，部署这个应用的war包</li> <li>对于一个大型应用，我们不可能把所有内容都放在一个应用里面，如何维护 、如何分工都是问题</li></ul> <blockquote><p>微服务架构</p></blockquote> <p>all in one 的架构方式，我们把所有的功能单元放在一个应用里面，然后我们把整个应用部署到服务器上，如果负载能力不行，我们将整个应用进行水平复制，</p> <p>进行扩展，然后再负载均衡</p> <p>所谓<em>微服务架构</em>，就是打破之前 all in one 的架构方式，把每个功能元素独立起来，把独立出来的功能元素动态组合，需要的功能元素才拿来组合，需要多一些时间整合多个功能元素；所以微服务架构是对功能元素进行复制，而没有对整个应用进行复制</p> <p>好处：</p> <ul><li>节省了调用资源</li> <li>每个功能元素的服务都是一个可替换的、可独立升级的软件代码</li></ul> <h2 id="第一个spring-boot-程序"><a href="#第一个spring-boot-程序" class="header-anchor">#</a> 第一个Spring Boot 程序</h2> <p>官方文档：https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-documentation</p> <p>官方提供了一个快速生成的网站；idea集成了这个网站</p> <ul><li><p>可以在官网下载后，导入idea开发 [https://start.spring.io/]</p></li> <li><p>如果官方网站不能使用，可以使用 [https://start.aliyun.com] 代替</p></li> <li><p>直接使用idea创建一个springboot项目</p> <p><img src="/study/assets/img/image-20210417091103921.9b153a8c.png" alt="image-20210417091103921"></p></li></ul> <blockquote><p>controller</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><blockquote><p>扩展-彩蛋</p></blockquote> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment"># 更改项目的端口号\</span>
<span class="token key attr-name">server.port</span> <span class="token punctuation">=</span> <span class="token value attr-value">8088</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>修改springboot横幅 banner</p></blockquote> <p>在线生成网站 [https://www.bootschool.net/ascii]</p> <p>创建banner.txt 里面粘贴在生成网站复制的内容</p> <p><img src="/study/assets/img/image-20210417094342219.cd4fd57e.png" alt="image-20210417094342219"></p> <p>效果图</p> <p><img src="/study/assets/img/image-20210417094038187.1e1aa6c1.png" alt="image-20210417094038187"></p> <h2 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h2> <blockquote><p>自动配置</p></blockquote> <p>pom.xml</p> <ul><li><div class="language-xml line-numbers-mode"><pre class="language-xml"><code>spring-boot-dependencies : 核心依赖在父工程中
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>我们在写或者引入一些SpringBoot的时候不需要指定版本，就是因为有这些版本仓库</p> <p><img src="/study/assets/img/image-20210417095125854.375e2ad5.png" alt="image-20210417095125854"></p></li></ul> <blockquote><p>启动器</p></blockquote> <ul><li><div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>启动器：说白了就是SpringBoot的启动场景</p></li> <li><p>比如spring-boot-starter-web，会自动帮我们导入web环境所有的依赖</p></li> <li><p>SpringBoot会将所有的功能场景，都变成一个个启动器</p></li> <li><p>我们要使用什么功能，就只需要找到对应的启动器就可以了<code>starter</code></p></li></ul> <blockquote><p>主程序</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//@SpringBootApplication：标注这个类是一个springboot应用：启动类下的所有资源被导入</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Springboot01Application</span> <span class="token punctuation">{</span>
    <span class="token comment">//通过run将springboot启动</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Springboot01Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><p>注解</p> <ul><li><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//springboot的配置</span>
<span class="token annotation punctuation">@SpringBootConfiguration</span>
	<span class="token comment">//spring配置类</span>
	<span class="token annotation punctuation">@Configuration</span>

<span class="token comment">//自动配置</span>
<span class="token annotation punctuation">@EnableAutoConfiguration</span>
	<span class="token comment">//自动配置包</span>
	<span class="token annotation punctuation">@AutoConfigurationPackage</span>
		<span class="token comment">//自动配置 `包注册`</span>
		<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationPackages<span class="token punctuation">.</span>Registrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token comment">//自动配置导入选择</span>
	<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
		<span class="token comment">//获取所有的配置</span>
		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations <span class="token operator">=</span> <span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//获取候选的配置</span>
		<span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> metadata<span class="token punctuation">,</span> <span class="token class-name">AnnotationAttributes</span> attributes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations <span class="token operator">=</span> <span class="token class-name">SpringFactoriesLoader</span><span class="token punctuation">.</span><span class="token function">loadFactoryNames</span><span class="token punctuation">(</span><span class="token function">getSpringFactoriesLoaderFactoryClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token function">getBeanClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notEmpty</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> <span class="token string">&quot;No auto configuration classes found in META-INF/spring.factories. If you &quot;</span>
				<span class="token operator">+</span> <span class="token string">&quot;are using a custom packaging, make sure that file is correct.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> configurations<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li> <li><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token constant">META</span><span class="token operator">-</span><span class="token constant">INF</span><span class="token operator">/</span>spring<span class="token punctuation">.</span>factories：自动配置的核心文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/study/assets/img/image-20210417101611143.cb8dc177.png" alt="image-20210417101611143"></p></li></ul></li></ul> <p><strong>SpringBoot所有的自动配置都是在启动的时候扫描并加载：<code>spring.factories</code>所有的自动配置类都在这里面，但是不一定生效，要判断条件是否成立，只要导入了对应的start，就有对应的启动器，有了启动器我们自动装配就会生效，然后配置成功</strong></p> <ol><li>springboot在启动的时候，从类路径下/META-INF/<code>spring.factories</code>获取指定的值</li> <li>将这些自动配置的类导入容器，自动配置就会生效，帮我们进行自动配置</li> <li>以前我们需要自动配置的东西，现在springboot帮我们做了</li> <li>整合javaEE，解决方案和自动配置的东西都在spring-boot-autoconfigure-2.4.5.jar这个包下</li> <li>它会把所有需要导入的组件，以类名的方式返回，这些组件会添加到容器中</li> <li>容器中也会存在非常多的xxxAutoConfiguration的文件（@Bean），就是这些类给容器中导入了这个场景需要的所有组件；并自动配置，@Configuration，JavaConfig</li> <li>有了自动配置类，就免去了我们手动编写配置文件的工作</li></ol> <blockquote><p>SpringApplication</p> <blockquote><p>推断应用是普通项目还是Web项目</p> <p>查找并加载所有可用初始化器，设置到initializers属性中</p> <p>找出所有的应用程序监听器，设置到listeners属性中</p> <p>推断并设置main方法的定义类，找到运行的主类</p></blockquote> <p>JavaConfig 核心：@Configuration	@Bean</p></blockquote> <h2 id="yaml"><a href="#yaml" class="header-anchor">#</a> yaml</h2> <p><strong>配置文件必须以application开头</strong></p> <p><img src="/study/assets/img/image-20210417184827919.1a679325.png" alt="image-20210417184827919"></p> <blockquote><p>yaml 语法 (yml)</p></blockquote> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8088</span>

<span class="token comment"># 对象</span>
<span class="token key atrule">student</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> naihe
  <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">18</span>

<span class="token key atrule">student</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">name</span><span class="token punctuation">:</span> naihe<span class="token punctuation">,</span><span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span>

<span class="token comment">#数组</span>
<span class="token key atrule">pets</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> cat
  <span class="token punctuation">-</span> dog
  <span class="token punctuation">-</span> pig
<span class="token key atrule">pets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>cat<span class="token punctuation">,</span>pig<span class="token punctuation">,</span>dog<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>yaml可以给实体类赋值</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># 每一个都对应实体类person dog 自己建</span>

<span class="token comment"># 人类</span>
<span class="token key atrule">person</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> naihe
  <span class="token key atrule">age</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>random.int<span class="token punctuation">}</span> <span class="token comment"># 随机数  ${person.name:naihe} 判断 如果没有name属性 值为naihe</span>
  <span class="token key atrule">birth</span><span class="token punctuation">:</span> 2021/4/17
  <span class="token key atrule">map</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">k1</span><span class="token punctuation">:</span> v1<span class="token punctuation">,</span><span class="token key atrule">k2</span><span class="token punctuation">:</span> v2<span class="token punctuation">}</span>
  <span class="token key atrule">list</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> code
    <span class="token punctuation">-</span> music
    <span class="token punctuation">-</span> game
  <span class="token key atrule">dog</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> gougou
    <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">8</span>
<span class="token comment"># 狗类</span>
<span class="token key atrule">dog</span><span class="token punctuation">:</span>
  <span class="token key atrule">first-name</span><span class="token punctuation">:</span> 花花
  <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">8</span>


数据绑定还可以通过
实体类 firstName <span class="token punctuation">---</span> 配置文件 first<span class="token punctuation">-</span>name
这种方式来进行匹配
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><blockquote><p>松散绑定</p> <blockquote><p>在yml中写的是last-name，这个和lastName是一样的，<code>-</code> 后面跟着的字母默认是大写的 这就是松散绑定</p></blockquote></blockquote> <blockquote><p>结论</p> <blockquote><p>配置yml和配置properties都可以获取值，推荐yml</p> <p>如果在某个业务中，只需要获取配置文件中的某个值，可以使用@value</p> <p>如果我们专门编写了一个JavaBean来和配置文件进行映射，直接使用@configurationProperties</p></blockquote></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span> <span class="token comment">//实例化到spring容器中</span>
<span class="token comment">//数据校验</span>
<span class="token annotation punctuation">@Validated</span>
<span class="token comment">//绑定配置文件中的配置</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;person&quot;</span><span class="token punctuation">)</span>
<span class="token comment">//@PropertySource(value = &quot;classpath:application.properties&quot;) 加载指定配置文件</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;邮箱格式错误&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> birth<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Dog</span> dog<span class="token punctuation">;</span>

    getter<span class="token operator">/</span>setter 构造<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="配置文件优先级"><a href="#配置文件优先级" class="header-anchor">#</a> 配置文件优先级</h2> <blockquote><p>springboot启动会扫描以下位置的application.properties或者application.yml文件作为SpringBoot的默认配置文件</p></blockquote> <blockquote><p>访问优先级</p> <ol><li>项目路径下的config文件夹中配置文件</li> <li>项目路径下配置文件</li> <li>资源路径下的config文件夹中配置文件</li> <li>资源路径下配置文件</li></ol> <p><code>优先级由高到低，高优先级配置会覆盖低优先级配置</code></p></blockquote> <h2 id="静态资源"><a href="#静态资源" class="header-anchor">#</a> 静态资源</h2> <blockquote><p>WebProperties 类路径</p></blockquote> <img src="/study/assets/img/image-20210524095107647.0e22c42c.png" alt="image-20210524095107647" style="zoom:80%;"> <img src="/study/assets/img/image-20210524095221437.b4c288f1.png" alt="image-20210524095221437" style="zoom:80%;"> <img src="/study/assets/img/image-20210524095331103.9385cb1f.png" alt="image-20210524095331103" style="zoom:80%;"> <blockquote><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Resources</span> <span class="token punctuation">{</span>
 <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token constant">CLASSPATH_RESOURCE_LOCATIONS</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;classpath:/META-INF/resources/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;classpath:/resources/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;classpath:/static/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;classpath:/public/&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>静态资源访问：</p> <blockquote><p>配置类</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UploadConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addResourceHandlers</span><span class="token punctuation">(</span><span class="token class-name">ResourceHandlerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 访问路径</span>
        registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">&quot;/image/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:/image/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></blockquote></blockquote> <h2 id="jsr-数据校验"><a href="#jsr-数据校验" class="header-anchor">#</a> JSR 数据校验</h2> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 引入validation依赖 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><table><thead><tr><th>Constraint</th> <th>详细信息</th></tr></thead> <tbody><tr><td>@Null</td> <td>被注释的元素必须为 null</td></tr> <tr><td>@NotNull</td> <td>被注释的元素必须不为 null</td></tr> <tr><td>@AssertTrue</td> <td>被注释的元素必须为 true</td></tr> <tr><td>@AssertFalse</td> <td>被注释的元素必须为 false</td></tr> <tr><td>@Min(value)</td> <td>被注释的元素必须是一个数字，其值必须大于等于指定的最小值</td></tr> <tr><td>@Max(value)</td> <td>被注释的元素必须是一个数字，其值必须小于等于指定的最大值</td></tr> <tr><td>@DecimalMin(value)</td> <td>被注释的元素必须是一个数字，其值必须大于等于指定的最小值</td></tr> <tr><td>@DecimalMax(value)</td> <td>被注释的元素必须是一个数字，其值必须小于等于指定的最大值</td></tr> <tr><td>@Size(max, min)</td> <td>被注释的元素的大小必须在指定的范围内</td></tr> <tr><td>@Digits (integer, fraction)</td> <td>被注释的元素必须是一个数字，其值必须在可接受的范围内</td></tr> <tr><td>@Past</td> <td>被注释的元素必须是一个过去的日期</td></tr> <tr><td>@Future</td> <td>被注释的元素必须是一个将来的日期</td></tr> <tr><td>@Pattern(value)</td> <td>被注释的元素必须符合指定的正则表达式</td></tr></tbody></table> <table><thead><tr><th>Constraint</th> <th>详细信息</th></tr></thead> <tbody><tr><td>@Email</td> <td>被注释的元素必须是电子邮箱地址</td></tr> <tr><td>@Length</td> <td>被注释的字符串的大小必须在指定的范围内</td></tr> <tr><td>@NotEmpty</td> <td>被注释的字符串的必须非空</td></tr> <tr><td>@Range</td> <td>被注释的元素必须在合适的范围内</td></tr></tbody></table> <table><thead><tr><th>Constraint</th> <th>详细信息</th></tr></thead> <tbody><tr><td>@NotNull（message=&quot;名字不能为空&quot;）</td> <td>private String userName；</td></tr> <tr><td>@Max（value=120，message=&quot;年龄最大不能查过12e&quot;）</td> <td>private int age；</td></tr> <tr><td>@Email（mes sage=&quot;邮箱格式错误&quot;）</td> <td>private String email；</td></tr> <tr><td><em><strong>空检查</strong></em></td> <td></td></tr> <tr><td>@Null</td> <td>验证对象是否为null</td></tr> <tr><td>@NotNull</td> <td>验证对象是否不为null，无法查检长度为e的字符串</td></tr> <tr><td>@NotBlank</td> <td>检查约束字符串是不是Null还有被Trim的长度是否大于e，只对字符串，且会去掉前后空格。</td></tr> <tr><td>@NotEmpty</td> <td>检查约束元素是否为NULL或者是EMPTY.</td></tr> <tr><td><em><strong>Booelan检查</strong></em></td> <td></td></tr> <tr><td>@AssertTrue</td> <td>验证Boolean 对象是否为true</td></tr> <tr><td>@</td> <td>验证 Boolean 对象是否为false长度检查</td></tr> <tr><td>@size（min=，max=）</td> <td>验证对象（Array，Collection，Map，String）长度是否在给定的范围之内</td></tr> <tr><td>@Length（min=，max=）</td> <td>Validates that the annotated string is between min and max included.</td></tr> <tr><td><em><strong>日期检查</strong></em></td> <td></td></tr> <tr><td>@Past</td> <td>验证 Date和Calendar对象是否在当前时间之前</td></tr> <tr><td>@Future</td> <td>验证Date和Calendar对象是否在当前时间之后</td></tr> <tr><td>@Pattern</td> <td>验证 String对象是否符合正则表达式的规则</td></tr></tbody></table> <p><em>除此之外 我们还可以自定义数据校验规则</em></p> <ul><li><p>如果在数据校验的时候(例：@Email) 飘红 在pom.xml中导入依赖</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <h2 id="多环境配置"><a href="#多环境配置" class="header-anchor">#</a> 多环境配置</h2> <blockquote><p>yaml 动态配置绑定</p> <blockquote><p>springboot的多环境配置：可以选择激活哪一个配置文件</p> <blockquote><p>properties</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token value attr-value">dev  		# 开发环境      ---&gt;对应的配置文件        application-dev.yml</span>
<span class="token key attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token value attr-value">test 		# 测试环境      ---&gt;对应的配置文件        application-test.yml</span>
<span class="token key attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token value attr-value">prod 		# 生产环境      ---&gt;对应的配置文件        application-prod.yml</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>yml</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
<span class="token key atrule">profiles</span><span class="token punctuation">:</span>
 <span class="token key atrule">active</span><span class="token punctuation">:</span> dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></blockquote></blockquote></blockquote> <h2 id="自动配置原理"><a href="#自动配置原理" class="header-anchor">#</a> 自动配置原理</h2> <h3 id="配置文件到底能写什么"><a href="#配置文件到底能写什么" class="header-anchor">#</a> 配置文件到底能写什么？</h3> <p>我们想要知道yml里面可以写什么，那么找spring.properties这个文件，看里面的路径，找到对应路径里面的类，看这个类上面的注解，还有这个类里面的属性。那么组合起来就是我们可以在yml里面配置的东西</p> <p>配置文件可以写配置类中所有的东西</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//表示这是一个配置类</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token comment">//自动配置属性：xxx</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span>xxx<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>spring底层注解：根据不同条件来判断当前配置或者类是否生效</code></p> <p><img src="/study/assets/img/image-20210418103531844.5887c72a.png" alt="image-20210418103531844"></p> <blockquote><p>每一个XxxxAutoConfiguration自动配置类都是在某些条件之下才会生效的，这些条件的限制在Spring Boot中以注解的形式体现，常见的<strong>条件注解</strong>有如下几项：</p></blockquote> <blockquote><p>@Conditional 扩展</p></blockquote> <p><img src="/study/assets/img/image-20210418103834493.c046beee.png" alt="image-20210418103834493"></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>在配置文件中能配置的东西，都存在一个规律     xxxAutoConfiguration	xxxProperties	和	配置文件绑定  我们就可以使用自定义配置了
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>原理</p></blockquote> <ul><li><p>SpringBoot启动会加载大量的自动配置类</p></li> <li><p>我们看我们需要的功能有没有在SpringBoot默认写好的自动配置类当中</p></li> <li><p>我们再来看看这个自动配置类中配置了哪些组件；只要我们要用的组件在其中，就不需要我们再手动配置了</p></li> <li><p>给容器中自动配置类添加组件的时候，会从properties类中获取某些属性，我们只需要在配置文件中指定这些属性的值即可；</p> <p>xxxAutoConfiguration：自动配置类；给容器中添加组件</p> <p>xxxProperties：封装配置文件中相关属性</p></li></ul> <blockquote><p>通过debug = true 来查看 哪些自动配置类生效，哪些没有生效</p></blockquote> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">debug</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="web"><a href="#web" class="header-anchor">#</a> Web</h2> <blockquote><p>静态资源</p> <blockquote><p>优先级：</p> <p>resources &gt; static &gt; public &gt; templates</p></blockquote> <p>首页</p> <p>图标</p> <blockquote><div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">关闭默认图标：spring.mvc.favicon.enabled</span><span class="token punctuation">=</span><span class="token value attr-value">false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote></blockquote> <h3 id="模板引擎-thymeleaf"><a href="#模板引擎-thymeleaf" class="header-anchor">#</a> 模板引擎(thymeleaf)</h3> <p><code>官方文档：</code>https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#a-multi-language-welcome</p> <p>需要使用thymeleaf，只需要导入对应的依赖就可以了</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.thymeleaf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>thymeleaf-spring5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.thymeleaf.extras<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>thymeleaf-extras-java8time<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.4.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><blockquote><p>在html中 引入 &lt;html lang=&quot;en&quot; xmlns:th=&quot;www.thymeleaf.org&quot;&gt;</p></blockquote> <blockquote><p>thymeleaf 标签</p></blockquote> <blockquote><p>赋值：</p></blockquote> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${msg}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>不转义<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">th:</span>utext</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${msg}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>转义<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>遍历</p></blockquote> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">th:</span>each</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user:${users}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${user}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">th:</span>each</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user:${users}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>[[${user}]]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- [[${user}]] 这种方式也可以赋值 但不推荐使用 --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="spring-mvc-自动配置扩展"><a href="#spring-mvc-自动配置扩展" class="header-anchor">#</a> Spring MVC 自动配置扩展</h2> <blockquote><p>视图跳转</p></blockquote> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-thymeleaf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 先引入 thymeleaf 依赖 否则视图解析不到</span>
<span class="token comment">// 首先要实现 WebMvcConfigurer 接口</span>
<span class="token comment">// 视图跳转</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addViewControllers</span><span class="token punctuation">(</span><span class="token class-name">ViewControllerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    						<span class="token comment">// url				视图名字</span>
     registry<span class="token punctuation">.</span><span class="token function">addViewController</span><span class="token punctuation">(</span><span class="token string">&quot;/naihe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;show&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><code>在springboot中，有非常多的xxxConfiguration帮助我们进行扩展配置</code></p> <h2 id="整合jdbc"><a href="#整合jdbc" class="header-anchor">#</a> 整合JDBC</h2> <blockquote><p>创建一个SpringBoot项目</p></blockquote> <blockquote><p>导入依赖</p></blockquote> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- web --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- jdbc --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- mysql --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><blockquote><p>编写配置文件</p></blockquote> <p><strong>application.properties</strong></p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token value attr-value">dev</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>application.yml</strong></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># 连接数据库</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3308/userdb<span class="token punctuation">?</span>serverTimezone=UTC<span class="token important">&amp;useUnicode=true&amp;characterEncoding=UTF-</span><span class="token number">8</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>测试类</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;naihe&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">;</span> <span class="token comment">// jdbcTemplate 是Spring对JDBC的封装，让JDBC更加易于使用</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">/**
     * 查询所有用户信息
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;select * from user&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> mapList <span class="token operator">=</span> jdbcTemplate<span class="token punctuation">.</span><span class="token function">queryForList</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> mapList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 添加用户信息
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;insert into user values (0,'林寒','linhan')&quot;</span><span class="token punctuation">;</span>
        jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// update() 一般用于执行 insert update delete 等DML语句</span>
        <span class="token keyword">return</span> <span class="token string">&quot;ok-add&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 修改用户信息
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;update&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;update user set uname = '林涵' where uid = '10005'&quot;</span><span class="token punctuation">;</span>
        jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;ok-update&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 删除用户信息
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;delete/{uid}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token keyword">int</span> uid<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;delete from user where uid = ?&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// 参数方式</span>
        jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;ok-delete&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h2 id="druid"><a href="#druid" class="header-anchor">#</a> Druid</h2> <blockquote><p>Druid是阿里巴巴开源平台上一个数据库连接池实现，结合了C3P0、DBCP、PROXOOL等DB池的优点，同时加入了日志监控</p></blockquote> <blockquote><p>Druid可以很好的监控DB池连接和SQL执行情况，天生就是针对监控而生的DB连接池</p></blockquote> <h3 id="使用druid"><a href="#使用druid" class="header-anchor">#</a> 使用Druid</h3> <blockquote><p>导入依赖</p></blockquote> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>修改 application.yml 配置文件</p></blockquote> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">type</span><span class="token punctuation">:</span> com.alibaba.druid.pool.DruidDataSource
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/study/assets/img/image-20210510112219020.d1a91b1e.png" alt=""></p> <p>数据源变成了 DruidDataSource</p> <p><img src="/study/assets/img/image-20210510113108270.22737b9d.png" alt="image-20210510113108270"></p> <blockquote><p>自定义配置</p></blockquote> <p>创建一个配置类</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DruidConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.datasource&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 绑定 yml 配置文件</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">druidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 后台监控
     * @return
     */</span>

    <span class="token comment">// SpringBoot 内置了servlet容器 所以没有 web.xml 替代方法：ServletRegistrationBean</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ServletRegistrationBean</span> <span class="token function">registrationBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 相当于 web.xml</span>
        <span class="token class-name">ServletRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StatViewServlet</span><span class="token punctuation">&gt;</span></span> bean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StatViewServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;/druid/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 后台需要登录 账号和密码设置</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 增加配置</span>
        <span class="token comment">// key 是固定的 loginUsername loginPassword</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;loginUsername&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;naihe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;loginPassword&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;naihe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 允许谁可以访问</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;allow&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 禁止谁可以访问</span>
        <span class="token comment">// map.put(&quot;admin&quot;, &quot;192.168.**.**&quot;);</span>
        <span class="token comment">// 设置初始化参数</span>
        bean<span class="token punctuation">.</span><span class="token function">setInitParameters</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><blockquote><p>登录页面</p></blockquote> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">localhost</span><span class="token punctuation">:</span><span class="token header-value">端口号/druid</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><img src="data:image/png;base64,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" alt="image-20210510121129651" style="zoom:80%;"> <blockquote><p>登录成功后进入首页</p></blockquote> <p><img src="/study/assets/img/image-20210510121237928.11609a5f.png" alt="image-20210510121237928"></p> <p>刚开始进入时SQL监控是没有记录的，我们执行一条sql语句...</p> <p>SQL监控会新增一条记录</p> <p><img src="/study/assets/img/image-20210510122621131.a9ed0cb2.png" alt="image-20210510122621131"></p> <h2 id="整合mybatis"><a href="#整合mybatis" class="header-anchor">#</a> 整合Mybatis</h2> <blockquote><p>导入依赖</p></blockquote> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><em>它不是官方的，自研的，官方的都是以 spring 开头的</em></p> <blockquote><p>根据数据库创建实体类</p></blockquote> <blockquote><p>配置文件</p></blockquote> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3308/userdb<span class="token punctuation">?</span>serverTimezone=UTC<span class="token important">&amp;useUnicode=true&amp;characterEncoding=UTF-</span><span class="token number">8</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">type</span><span class="token punctuation">:</span> com.alibaba.druid.pool.DruidDataSource
<span class="token comment"># 设置端口号</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8088</span>
<span class="token comment">#  整合Mybatis</span>
<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">type-aliases-package</span><span class="token punctuation">:</span> com.it.pojo
  <span class="token key atrule">mapper-locations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapping/<span class="token important">*.xml</span>
  <span class="token comment"># 不要写成 /mapping/*.xml 否则spring回到项目根目录去找 （找不到）</span>
  <span class="token comment"># 下划线转驼峰命名  g_name ---&gt;  gName</span>
  <span class="token key atrule">map-underscore-to-camel-case</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><p>Mybatis 配置</p></blockquote> <p>省略 接口，biz...</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 表示这是一个 mybatis 的 mapper 类</span>
<span class="token annotation punctuation">@Mapper</span>		<span class="token comment">// 如果你不想写这个注释 可以在启动类里扫描 mapper 包	@MapperScan(&quot;com.it.mapper&quot;)</span>
<span class="token comment">// 这个注解是 将 UserMapper 注册到Bean</span>
<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 查询所有用户信息
     * @return
     */</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 根据ID查询用户
     * @return
     */</span>
    <span class="token class-name">User</span> <span class="token function">selectUserByID</span><span class="token punctuation">(</span><span class="token keyword">int</span> uid<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 修改用户信息
     * @param user
     */</span>
    <span class="token keyword">void</span> <span class="token function">updateUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 添加用户信息
     * @param user
     */</span>
    <span class="token keyword">void</span> <span class="token function">addUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 删除用户信息
     * @param uid
     */</span>
    <span class="token keyword">void</span> <span class="token function">deleteUser</span><span class="token punctuation">(</span><span class="token keyword">int</span> uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.it.mapper.UserMapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectUser<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>User<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select * from user
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectUserByID<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>User<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select * from user
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">&gt;</span></span>
            uid = #{uid}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>addUser<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>User<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        insert into user values (0,#{uname},#{upwd})
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>updateUser<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>User<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        update user
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">&gt;</span></span>
            upwd = #{upwd}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>set</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">&gt;</span></span>
            uid = #{uid}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>deleteUser<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        delete from user
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">&gt;</span></span>
            uid = #{uid}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delete</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><blockquote><p>控制层</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token comment">// 请求地址</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;naihe&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> userList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;listId/{uid}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">listId</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token keyword">int</span> uid<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectUserByID</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> user<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">{</span>
        userService<span class="token punctuation">.</span><span class="token function">addUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;ok-add&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;update&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">{</span>
        userService<span class="token punctuation">.</span><span class="token function">updateUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;ok-update&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;delete/{uid}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token keyword">int</span> uid<span class="token punctuation">)</span><span class="token punctuation">{</span>
        userService<span class="token punctuation">.</span><span class="token function">deleteUser</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;ok-delete&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><blockquote><p>项目结构</p></blockquote> <img src="/study/assets/img/image-20210510145241218.5d859b72.png" alt="image-20210510145241218" style="zoom:80%;"> <h2 id="spring-security"><a href="#spring-security" class="header-anchor">#</a> Spring Security</h2> <blockquote><p>Spring Security是一个功能强大且高度可定制的身份验证和访问控制框架。它是用于保护基于Spring的应用程序的事实上的标准。</p></blockquote> <p><strong>Spring Security 核心功能</strong></p> <ul><li>认证（你是谁）</li> <li>授权（能做些什么）</li> <li>攻击防护（防止伪造身份）</li></ul> <blockquote><p>Spring Security 过滤器</p></blockquote> <p><img src="/study/assets/img/2018030516271456.24f17ce3.png" alt="2018030516271456"></p> <blockquote><p>官网</p> <blockquote><blockquote><p>版本	5.4.6</p></blockquote> <p>https://spring.io/projects/spring-security</p> <p>https://docs.spring.io/spring-security/site/docs/5.4.6/reference/html5/</p></blockquote></blockquote> <blockquote><p>导入模块</p></blockquote> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>几个比较重要的类</p></blockquote> <ul><li><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">WebSecurityConfigurerAdapter</span> ：自定义<span class="token class-name">Security</span>策略
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">AuthenticationManagerBuilder</span> ：自定义认证策略
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@EnableWebSecurity</span> ：开启<span class="token class-name">WebSecurity</span>模式
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <blockquote><p>配置类</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 链式编程
     * 授权
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// 首页所有人都可以访问，功能页只有对应有权限的人才可以访问</span>
        <span class="token comment">// 请求授权的规则</span>
        http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/naihe/level1/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">&quot;vip1&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/naihe/level2/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">&quot;vip2&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/naihe/level3/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">&quot;vip3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 没有权限默认会到登录页</span>
        http<span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 注销 后跳转到首页</span>
        http<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">logoutSuccessUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 开启记住我功能</span>
        http<span class="token punctuation">.</span><span class="token function">rememberMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 认证
     * @param auth
     * @throws Exception
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        							<span class="token comment">// 这里要进行一个密码编码 否则系统会认为它是不安全的</span>
        							<span class="token comment">// BCryptPasswordEncoder 只是一种加密方式</span>
        							<span class="token comment">// 可以选择其他的加密方式</span>
        auth<span class="token punctuation">.</span><span class="token function">inMemoryAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withUser</span><span class="token punctuation">(</span><span class="token string">&quot;naihe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&quot;naihe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">&quot;vip1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;vip2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;vip3&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withUser</span><span class="token punctuation">(</span><span class="token string">&quot;vip1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">&quot;vip1&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withUser</span><span class="token punctuation">(</span><span class="token string">&quot;vip2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">&quot;vip2&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withUser</span><span class="token punctuation">(</span><span class="token string">&quot;vip3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">&quot;vip3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 没有密码加密在登录时会出现错误</span>
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>IllegalArgumentException</span><span class="token operator">:</span> <span class="token class-name">There</span> is no <span class="token class-name">PasswordEncoder</span> mapped <span class="token keyword">for</span> the id <span class="token string">&quot;null&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>&quot;记住我&quot;功能</p></blockquote> <img src="/study/assets/img/image-20210511154228396.9af638aa.png" alt="image-20210511154228396" style="zoom:80%;"> <p>这个功能开启后，关闭浏览器再次打开网页时，网页会自动保存上一次登录信息</p> <p>会把登录信息保存在cookie里</p> <p><em>不开启当然就是无效的</em></p> <img src="/study/assets/img/image-20210511153944752.671cfe1e.png" alt="image-20210511153944752" style="zoom:80%;"> <blockquote><p>完成对应用户显示对应操作</p> <p>登录显示注销</p> <p>没登录显示登录</p></blockquote> <blockquote><p>登录页面</p></blockquote> <img src="/study/assets/img/image-20210511152917599.8ad7bbca.png" alt="image-20210511152917599" style="zoom:80%;"> <p><strong>这个登录页面是 Spring Security 提供的</strong></p> <blockquote><p>导入 thymeleaf security 整合包</p></blockquote> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.thymeleaf.extras<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>thymeleaf-extras-springsecurity5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.4.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--
	导 5 别导 4
	导 4 不生效
	或者降版本也可以
  --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>在 html 导入命名空间</p></blockquote> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>th</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.thymeleaf.org<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>sec</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.thymeleaf.org/extras/spring-security<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!--
	authentication：显示登录名
	authorize：如果登录了就显示
	!authorize：反之（没登录显示）
  --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span> <span class="token attr-name"><span class="token namespace">sec:</span>authentication</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">sec:</span>authorize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isAuthenticated()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!--
	如果登录的用户有vip1权限就显示，否则不显示
  --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">sec:</span>authorize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hasRole('vip1')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dl</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dt</span><span class="token punctuation">&gt;</span></span>vip1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dt</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dd</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/naihe/level1/1}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>level1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dd</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dd</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/naihe/level1/2}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>level2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dd</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dd</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/naihe/level1/3}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>level3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dd</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dl</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>如何把登录页设成我们自己的</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 在配置类中 添加 loginPage方法</span>
<span class="token comment">// loginProcessingUrl : 认证页</span>
http<span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loginPage</span><span class="token punctuation">(</span><span class="token string">&quot;/naihe/toLogin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loginProcessingUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/naihe/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 如果前端表单name不是username、password 系统会找不到名字</span>
<span class="token comment">// 更改name太过麻烦</span>
<span class="token comment">// 可以通过添加 usernameParameter() passwordParameter() 方法进行修改</span>

<span class="token function">usernameParameter</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span>
<span class="token function">passwordParameter</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>绑定”记住我“功能</p></blockquote> <p>在页面添加复选框</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!--name不可少--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>remember<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>记住我
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>在配置文件中添加配置</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// rememberMeParameter : 参数为自定义name</span>
http<span class="token punctuation">.</span><span class="token function">rememberMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rememberMeParameter</span><span class="token punctuation">(</span><span class="token string">&quot;remember&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>注销</p></blockquote> <ul><li>更改了登录页之后，它自己的logout就失效了</li> <li>如果需要注销，就自己写一个</li> <li>不需要修改配置类</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 控制类</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;exit&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 获取cookie</span>
    <span class="token class-name">Cookie</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cookies <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getCookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Cookie</span> cookie <span class="token operator">:</span> cookies<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 指定cookie重新赋值</span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> cookie<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;remember-me&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cookie<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                cookie<span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                cookie<span class="token punctuation">.</span><span class="token function">setMaxAge</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                response<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;JSESSIONID&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cookie<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                cookie<span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                cookie<span class="token punctuation">.</span><span class="token function">setMaxAge</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                response<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token string">&quot;redirect:/naihe/toLogin&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><blockquote><p>对应的html页面</p></blockquote> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">'/naihe/exit'</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>注销<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="shiro"><a href="#shiro" class="header-anchor">#</a> Shiro</h2> <blockquote><p>Shiro 简介</p></blockquote> <p><strong>Apache</strong> Shiro™是一个功能强大且易于使用的Java安全框架，它执行身份验证、授权、加密和会话管理。</p> <p>通过Shiro易于理解的API，您可以快速轻松地保护任何应用程序——从最小的移动应用程序到最大的web和企业应用程序</p> <blockquote><p>官网</p></blockquote> <p>Shiro：https://shiro.apache.org</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/study/assets/js/app.6d3630f5.js" defer></script><script src="/study/assets/js/2.40365491.js" defer></script><script src="/study/assets/js/1.eec64618.js" defer></script><script src="/study/assets/js/15.04415536.js" defer></script>
  </body>
</html>
