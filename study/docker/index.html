<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | Study Notes</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/study/logo.svg">
    <meta name="description" content="">
    
    <link rel="preload" href="/study/assets/css/0.styles.7d302c8d.css" as="style"><link rel="preload" href="/study/assets/js/app.6d3630f5.js" as="script"><link rel="preload" href="/study/assets/js/2.40365491.js" as="script"><link rel="preload" href="/study/assets/js/1.eec64618.js" as="script"><link rel="preload" href="/study/assets/js/18.ba9636f0.js" as="script"><link rel="prefetch" href="/study/assets/js/10.bfd158aa.js"><link rel="prefetch" href="/study/assets/js/11.ee769b27.js"><link rel="prefetch" href="/study/assets/js/12.c5502306.js"><link rel="prefetch" href="/study/assets/js/13.772ba8b8.js"><link rel="prefetch" href="/study/assets/js/14.eb7a6da8.js"><link rel="prefetch" href="/study/assets/js/15.04415536.js"><link rel="prefetch" href="/study/assets/js/16.b81b8892.js"><link rel="prefetch" href="/study/assets/js/17.faf137c3.js"><link rel="prefetch" href="/study/assets/js/19.2a36490d.js"><link rel="prefetch" href="/study/assets/js/20.cb0fe819.js"><link rel="prefetch" href="/study/assets/js/21.fdfe156a.js"><link rel="prefetch" href="/study/assets/js/22.aaf6fed9.js"><link rel="prefetch" href="/study/assets/js/23.fc8322ab.js"><link rel="prefetch" href="/study/assets/js/24.bfc40fb7.js"><link rel="prefetch" href="/study/assets/js/25.688b920d.js"><link rel="prefetch" href="/study/assets/js/26.9b302a72.js"><link rel="prefetch" href="/study/assets/js/27.0ba8ed8f.js"><link rel="prefetch" href="/study/assets/js/28.48655c0b.js"><link rel="prefetch" href="/study/assets/js/29.6726a437.js"><link rel="prefetch" href="/study/assets/js/3.e37420f1.js"><link rel="prefetch" href="/study/assets/js/30.185b360a.js"><link rel="prefetch" href="/study/assets/js/31.dfbef273.js"><link rel="prefetch" href="/study/assets/js/32.1382e380.js"><link rel="prefetch" href="/study/assets/js/33.5e7d748d.js"><link rel="prefetch" href="/study/assets/js/34.fde6461c.js"><link rel="prefetch" href="/study/assets/js/35.ca6fc384.js"><link rel="prefetch" href="/study/assets/js/36.29151333.js"><link rel="prefetch" href="/study/assets/js/37.6504d9c5.js"><link rel="prefetch" href="/study/assets/js/4.26fde88e.js"><link rel="prefetch" href="/study/assets/js/5.5e14a162.js"><link rel="prefetch" href="/study/assets/js/6.a5c47722.js"><link rel="prefetch" href="/study/assets/js/7.d769642e.js"><link rel="prefetch" href="/study/assets/js/vendors~docsearch.ca4cd80d.js">
    <link rel="stylesheet" href="/study/assets/css/0.styles.7d302c8d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/study/" class="home-link router-link-active"><img src="/study/logo.svg" alt="Study Notes" class="logo"> <span class="site-name can-hide">Study Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/study/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/study/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/study/spring/" class="nav-link">
  Spring
</a></div><div class="nav-item"><a href="/study/springboot/" class="nav-link">
  SpringBoot
</a></div><div class="nav-item"><a href="/study/es/" class="nav-link">
  Elasticsearch
</a></div><div class="nav-item"><a href="/study/docker/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Docker
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><span class="title">More</span> <span class="arrow down"></span></button> <button type="button" aria-label="More" class="mobile-dropdown-title"><span class="title">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/study/mybatisplus/" class="nav-link">
  MybatisPlus
</a></li><li class="dropdown-item"><!----> <a href="/study/springcloudgateway/" class="nav-link">
  SpringCloudGateway
</a></li><li class="dropdown-item"><!----> <a href="/study/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/study/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/study/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/study/nodejs/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/study/jvm/" class="nav-link">
  Jvm
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/study/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/study/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/study/spring/" class="nav-link">
  Spring
</a></div><div class="nav-item"><a href="/study/springboot/" class="nav-link">
  SpringBoot
</a></div><div class="nav-item"><a href="/study/es/" class="nav-link">
  Elasticsearch
</a></div><div class="nav-item"><a href="/study/docker/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Docker
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><span class="title">More</span> <span class="arrow down"></span></button> <button type="button" aria-label="More" class="mobile-dropdown-title"><span class="title">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/study/mybatisplus/" class="nav-link">
  MybatisPlus
</a></li><li class="dropdown-item"><!----> <a href="/study/springcloudgateway/" class="nav-link">
  SpringCloudGateway
</a></li><li class="dropdown-item"><!----> <a href="/study/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/study/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/study/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/study/nodejs/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/study/jvm/" class="nav-link">
  Jvm
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study/docker/#什么是docker" class="sidebar-link">什么是Docker?</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#为什么要使用docker" class="sidebar-link">为什么要使用Docker?</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#优势" class="sidebar-link">优势</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker相对于虚拟机的优势" class="sidebar-link">Docker相对于虚拟机的优势</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#基本组成" class="sidebar-link">基本组成</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker工作原理" class="sidebar-link">Docker工作原理</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#安装-ubuntu" class="sidebar-link">安装(Ubuntu)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/docker/#更新软件包" class="sidebar-link">更新软件包</a></li><li class="sidebar-sub-header"><a href="/study/docker/#安装docker依赖" class="sidebar-link">安装docker依赖</a></li><li class="sidebar-sub-header"><a href="/study/docker/#添加官方gpg密钥" class="sidebar-link">添加官方GPG密钥</a></li><li class="sidebar-sub-header"><a href="/study/docker/#添加docker软件源" class="sidebar-link">添加docker软件源</a></li><li class="sidebar-sub-header"><a href="/study/docker/#安装docker" class="sidebar-link">安装docker</a></li><li class="sidebar-sub-header"><a href="/study/docker/#配置用户组-可选" class="sidebar-link">配置用户组(可选)</a></li><li class="sidebar-sub-header"><a href="/study/docker/#验证docker引擎是否安装成功" class="sidebar-link">验证docker引擎是否安装成功</a></li></ul></li><li><a href="/study/docker/#安装完成后就卸载吧-不怀好意的笑" class="sidebar-link">安装完成后就卸载吧~(不怀好意的笑)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#镜像加速" class="sidebar-link">镜像加速</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#分析hello-world" class="sidebar-link">分析hello-world</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker为什么比虚拟机快" class="sidebar-link">Docker为什么比虚拟机快?</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker命令" class="sidebar-link">Docker命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/docker/#service-docker-start" class="sidebar-link">service docker start</a></li><li class="sidebar-sub-header"><a href="/study/docker/#service-docker-restart" class="sidebar-link">service docker restart</a></li><li class="sidebar-sub-header"><a href="/study/docker/#service-docker-stop" class="sidebar-link">service docker stop</a></li><li class="sidebar-sub-header"><a href="/study/docker/#service-docker-status" class="sidebar-link">service docker status</a></li><li class="sidebar-sub-header"><a href="/study/docker/#systemctl-enable-docker" class="sidebar-link">systemctl enable docker</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-info" class="sidebar-link">docker info</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-help" class="sidebar-link">docker --help</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-命令-help" class="sidebar-link">docker [命令] --help</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-images" class="sidebar-link">docker images</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-search-images" class="sidebar-link">docker search [images]</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-pull-images" class="sidebar-link">docker pull [images]</a></li><li class="sidebar-sub-header"><a href="/study/docker/#给镜像设置别名-打标签" class="sidebar-link">给镜像设置别名/打标签</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-system-df" class="sidebar-link">docker system df</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-rmi-镜像名称-镜像id" class="sidebar-link">docker rmi [镜像名称|镜像ID]</a></li><li class="sidebar-sub-header"><a href="/study/docker/#什么是docker虚悬镜像" class="sidebar-link">什么是docker虚悬镜像?</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-run-options-image" class="sidebar-link">docker run [options] image</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-ps" class="sidebar-link">docker ps</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-start-容器名称-id" class="sidebar-link">docker start [容器名称|ID]</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-restart" class="sidebar-link">docker restart ...</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-stop" class="sidebar-link">docker stop ...</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-kill" class="sidebar-link">docker kill ...</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-rm-容器id" class="sidebar-link">docker rm [容器ID]</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-logs-容器id" class="sidebar-link">docker logs [容器ID]</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-top-容器id" class="sidebar-link">docker top [容器ID]</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-inspect-container-id-or-name" class="sidebar-link">docker inspect [container_id_or_name]</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-exec-it-容器id" class="sidebar-link">docker exec -it [容器ID]</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-attach-容器id" class="sidebar-link">docker attach [容器ID]</a></li></ul></li><li><a href="/study/docker/#镜像和容器的关系" class="sidebar-link">镜像和容器的关系?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/docker/#docker-network-ls" class="sidebar-link">docker network ls</a></li><li class="sidebar-sub-header"><a href="/study/docker/#docker-network-create-network-name" class="sidebar-link">docker network create &lt;network_name&gt;</a></li></ul></li><li><a href="/study/docker/#docker网络" class="sidebar-link">Docker网络?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/docker/#docker-network-connect-network-name-container-id-or-name" class="sidebar-link">docker network connect  &lt;container_id_or_name&gt;</a></li></ul></li><li><a href="/study/docker/#文件拷贝" class="sidebar-link">文件拷贝</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#导出容器" class="sidebar-link">导出容器</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#导入容器" class="sidebar-link">导入容器</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker镜像层都是只读的-容器层是可写的" class="sidebar-link">Docker镜像层都是只读的, 容器层是可写的</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker-commit" class="sidebar-link">docker commit</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker推送镜像到私服" class="sidebar-link">docker推送镜像到私服</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker容器数据" class="sidebar-link">docker容器数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/docker/#可以通过ro或rw指定容器对数据卷的权限" class="sidebar-link">可以通过ro或rw指定容器对数据卷的权限</a></li><li class="sidebar-sub-header"><a href="/study/docker/#数据卷之间的继承和共享" class="sidebar-link">数据卷之间的继承和共享</a></li></ul></li><li><a href="/study/docker/#docker安装mysql" class="sidebar-link">docker安装mysql</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker安装redis" class="sidebar-link">docker安装redis</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker安装mongodb" class="sidebar-link">docker安装mongodb</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#docker部署springboot应用" class="sidebar-link">docker部署SpringBoot应用</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/study/docker/#dockerfile" class="sidebar-link">Dockerfile</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/docker/#docker执行dockerfile的流程" class="sidebar-link">docker执行Dockerfile的流程</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h1> <h2 id="什么是docker"><a href="#什么是docker" class="header-anchor">#</a> 什么是Docker?</h2> <blockquote><p>Docker是由go语言开发的一个开源应用容器引擎</p> <p>Docker可以让开发者打包应用程序到一个轻量级、可移植的容器中, 然后部署到任何系统上</p></blockquote> <p><strong>Docker是一种容器化平台，可以将应用程序及其依赖项打包到一个可移植的容器中，从而实现快速部署、可移植性和可伸缩性</strong></p> <h2 id="为什么要使用docker"><a href="#为什么要使用docker" class="header-anchor">#</a> 为什么要使用Docker?</h2> <blockquote><p>在Docker之前, n个开发人员就会有n个配置文件, 再部署环境时, 通常会有开发这边可以正常跑通, 而测试人员却说不行, 这就会出现环境不统一问题</p> <p>当需要部署多台服务器时, 每台服务器单独配置环境太繁琐, 而且会出现环境不匹配问题</p> <p>使用Docker之后, 这些问题都迎刃而解</p></blockquote> <img src="/study/assets/img/image-20231110162101499.687af80d.png" alt="image-20231110162101499" style="zoom:80%;"> <p>以Docker的角度来讲, 我们所部署的开发环境都可以打包为一个镜像文件, 在使用时 只需要拉取这个镜像文件即可</p> <h2 id="优势"><a href="#优势" class="header-anchor">#</a> 优势</h2> <ul><li>一次构建, 随处运行</li> <li>更快速的应用交付和部署</li> <li>更简单的系统运维</li> <li>更便捷的系统升级和扩展</li> <li>不用担心环境不统一问题</li></ul> <p><strong>docker只做三件事, 打包、发布、运行</strong></p> <h2 id="docker相对于虚拟机的优势"><a href="#docker相对于虚拟机的优势" class="header-anchor">#</a> Docker相对于虚拟机的优势</h2> <ul><li>轻量级</li> <li>启动快</li> <li>资源占用少</li></ul> <p><strong>docker容器在操作系统层面实现虚拟化, 直接复用本地操作系统, 而传统虚拟机则是在硬件层面进行虚拟化, 与传统虚拟机相比, docker启动更快, 体积更小</strong></p> <h2 id="基本组成"><a href="#基本组成" class="header-anchor">#</a> 基本组成</h2> <ul><li><p>镜像「images」</p> <blockquote><p>可以理解为是一个Linux的文件系统, 里面包含了可以运行在Linux内核的程序以及应用数据</p></blockquote> <p>扩展一下Linux知识:</p> <blockquote><p>通常Linux分为两个部分, Linux内核和用户空间, 而真正的Linux系统指的其实就是Linux内核</p> <p>常用的Ubuntu、CentOS等版本其实就是不同厂商在Linux内核的基础上扩展了自己的软件和工具所形成的版本</p></blockquote> <p><strong>因此我们可以将镜像看作是上面所讲的用户空间, 当docker通过镜像创建一个容器时, 就是将镜像定义好的用户空间作为独立隔离的进程运行在宿主机的Linux内核之上</strong></p> <ul><li>镜像是分层的, 一个镜像可以由多个中间层组成, 多个镜像可以共享同一中间层, 也可以通过在镜像中添加多一层来生成一个新镜像</li> <li>镜像是<strong>只读</strong>的, 镜像在构建完成之后就不可以在进行修改, 而上面所说的添加一层构建新镜像是指通过创建一个临时的容器, 在容器上进行文件的操作行为, 从而形成新的镜像, 而<strong>容器是可以动态改变的</strong></li></ul></li> <li><p>容器「container」</p> <blockquote><p>容器与镜像的关系就如同Java中对象与类的关系</p> <p>容器是通过镜像来创建的, 所以必须要有镜像才可以创建容器, 而生成的容器是独立于宿主机的隔离进程, 并且有属于自己的网络和命名空间</p></blockquote> <p><strong>镜像由多个中间层组成, 生成的镜像是只读的, 但容器却是可读写的, 这是因为容器是在镜像上面添加的一层读写层来实现的</strong></p> <img src="/study/assets/img/image-20231111134731464.605aad82.png" alt="image-20231111134731464" style="zoom:80%;"></li> <li><p>仓库「repository」</p> <ul><li><p>用来存储镜像的地方</p> <blockquote><p>仓库又分为公共仓库和私有仓库</p> <p>公共仓库一般指DockerHub, 我们可以从公共仓库中获取镜像, 如: nginx、redis、mysql等, 也可以上传自己的镜像</p> <p>私有仓库一般在团队内部需要共享镜像时, 但直接导出发给其他开发人员又比较麻烦, 因此可以搭建自己的私有仓库, 用于存储和发布自己的镜像</p></blockquote></li> <li><p>https://hub.docker.com/</p></li> <li><p>https://docker.mirrors.ustc.edu.cn/</p></li> <li><p>阿里云</p></li> <li><p>华为云</p></li> <li><p>...</p></li></ul></li></ul> <blockquote><p>三个元素对应三个命令, build、ship、run</p></blockquote> <h2 id="docker工作原理"><a href="#docker工作原理" class="header-anchor">#</a> Docker工作原理</h2> <blockquote><p>docker在运行容器时, 会先去本地查找镜像, 如果存在则直接运行, 否则会去远程仓库拉取镜像, 然后再去运行</p> <p>这点在我们第一次运行hello-world时会体验</p></blockquote> <img src="/study/assets/img/image-20231115161438827.e1e10778.png" alt="image-20231115161438827" style="zoom:80%;"> <h2 id="安装-ubuntu"><a href="#安装-ubuntu" class="header-anchor">#</a> 安装(Ubuntu)</h2> <p><a href="https://www.docker.com/" target="_blank" rel="noopener noreferrer">官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://docker.p2hp.com/" target="_blank" rel="noopener noreferrer">中文官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://docs.docker.com/engine/install/centos/" target="_blank" rel="noopener noreferrer">CentOS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank" rel="noopener noreferrer">Ubuntu<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>==注意我们安装的是引擎「Engine」不是桌面程序「Desktop」==</p> <blockquote><p>如果您的机器上安装过docker, 请先按照官网步骤删除残留docker文件</p></blockquote> <h3 id="更新软件包"><a href="#更新软件包" class="header-anchor">#</a> 更新软件包</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> update
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="安装docker依赖"><a href="#安装docker依赖" class="header-anchor">#</a> 安装docker依赖</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> ca-certificates <span class="token function">curl</span> gnupg lsb-release
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="添加官方gpg密钥"><a href="#添加官方gpg密钥" class="header-anchor">#</a> 添加官方GPG密钥</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 官方下载(可能会比较慢)</span>
<span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://download.docker.com/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -
<span class="token comment"># 阿里云镜像下载</span>
<span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="添加docker软件源"><a href="#添加docker软件源" class="header-anchor">#</a> 添加docker软件源</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> add-apt-repository <span class="token string">&quot;deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu <span class="token variable"><span class="token variable">$(</span>lsb_release <span class="token parameter variable">-cs</span><span class="token variable">)</span></span> stable&quot;</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> update
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="安装docker"><a href="#安装docker" class="header-anchor">#</a> 安装docker</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="配置用户组-可选"><a href="#配置用户组-可选" class="header-anchor">#</a> 配置用户组(可选)</h3> <blockquote><p>默认情况下只有root用户和docker组的用户才能使用docker命令, 我们可以将当前用户添加到docker组</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">usermod</span> <span class="token parameter variable">-aG</span> <span class="token function">docker</span> <span class="token environment constant">$USER</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>需要重新登录才能生效</strong></p> <h3 id="验证docker引擎是否安装成功"><a href="#验证docker引擎是否安装成功" class="header-anchor">#</a> 验证docker引擎是否安装成功</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 查看docker版本</span>
<span class="token function">sudo</span> <span class="token function">docker</span> version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><img src="/study/assets/img/image-20231115161023803.fba1fc94.png" alt="image-20231115161023803" style="zoom:80%;"> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 启动docker</span>
<span class="token function">sudo</span> <span class="token function">service</span> <span class="token function">docker</span> start
<span class="token comment"># 停止docker</span>
<span class="token function">sudo</span> <span class="token function">service</span> <span class="token function">docker</span> stop
<span class="token comment"># 重启docker</span>
<span class="token function">sudo</span> <span class="token function">service</span> <span class="token function">docker</span> restart
<span class="token comment"># 运行hello-world</span>
<span class="token function">sudo</span> <span class="token function">docker</span> run hello-world
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><img src="/study/assets/img/image-20231115160338325.b9b9ea0d.png" alt="image-20231115160338325" style="zoom:80%;"> <blockquote><p>很欣慰, 在安装时很给力, 一路绿灯😎</p></blockquote> <h2 id="安装完成后就卸载吧-不怀好意的笑"><a href="#安装完成后就卸载吧-不怀好意的笑" class="header-anchor">#</a> 安装完成后就卸载吧~(不怀好意的笑)</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">service</span> <span class="token function">docker</span> stop
<span class="token function">sudo</span> <span class="token function">apt-get</span> purge docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin docker-ce-rootless-extras
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/docker
<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/containerd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="镜像加速"><a href="#镜像加速" class="header-anchor">#</a> 镜像加速</h2> <blockquote><p>镜像源可以有多个选择, 比如阿里云、华为云、网易云等</p> <p>这里以**==华为云==**做例</p></blockquote> <p>在选择好镜像厂家后, 需要先进行<strong>登录</strong>, 然后在<strong>产品区域</strong>找到<strong>镜像加速服务/容器镜像服务</strong></p> <img src="/study/assets/img/image-20231115162431186.10d89e21.png" alt="image-20231115162431186" style="zoom:80%;"> <p>复制加速器地址并进行配置</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 进入/etc/docker目录下</span>
<span class="token builtin class-name">cd</span> /etc/docker
<span class="token function">vi</span> /etc/docker/daemon.json
<span class="token comment"># 添加以下内容</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;registry-mirrors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;registry-mirror-url&quot;</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment"># 重启docker</span>
<span class="token function">sudo</span> <span class="token function">service</span> <span class="token function">docker</span> restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><blockquote><p>输入<code>sudo docker info</code>查看镜像仓库是否配置成功</p></blockquote> <img src="/study/assets/img/image-20231115163918931.694fa8f0.png" alt="image-20231115163918931" style="zoom:80%;"> <p><strong>如果配置失败, 检查其他目录(/etc/sysconfig/docker、/etc/default/docker)中是否配置了<code>registry-mirros</code>参数</strong></p> <h2 id="分析hello-world"><a href="#分析hello-world" class="header-anchor">#</a> 分析hello-world</h2> <blockquote><p><code>run hello-world</code>做了什么事</p></blockquote> <blockquote><p>首先docker会在本地查找hello-world镜像, 如果本地存在则直接以该镜像为模板生产容器实例并运行</p> <p>不存在则会去镜像仓库中去查找hello-world, 如果能找到, 将hello-world拉取到本地并生产容器实例运行</p> <p>否则返回失败错误, 找不到hello-world</p></blockquote> <img src="/study/assets/img/image-20231115165537935.4e4b57b6.png" alt="image-20231115165537935" style="zoom:80%;"> <h2 id="docker为什么比虚拟机快"><a href="#docker为什么比虚拟机快" class="header-anchor">#</a> Docker为什么比虚拟机快?</h2> <ul><li><p>docker有更少的抽象层</p> <p>虚拟机加载的<code>iso</code>文件包含了软件、硬件、驱动等等, 不管用不用的到, 都会去进行加载, 而docker不会, docker容器上的程序直接使用实际物理机的硬件资源, 因此在CPU以及内存利用率上有明显的优势</p></li> <li><p>docker利用的是宿主机的内核, 不需要重新加载操作系统OS内核</p> <p>当新建一个容器时, docker不需要像虚拟机一样重新加载一个操作系统内核, 进而避免了引导、加载操作系统内核的时间</p></li></ul> <h2 id="docker命令"><a href="#docker命令" class="header-anchor">#</a> Docker命令</h2> <h3 id="service-docker-start"><a href="#service-docker-start" class="header-anchor">#</a> <code>service docker start</code></h3> <blockquote><p>启动docker</p></blockquote> <h3 id="service-docker-restart"><a href="#service-docker-restart" class="header-anchor">#</a> <code>service docker restart</code></h3> <blockquote><p>重启docker</p></blockquote> <h3 id="service-docker-stop"><a href="#service-docker-stop" class="header-anchor">#</a> <code>service docker stop</code></h3> <blockquote><p>停止docker</p></blockquote> <h3 id="service-docker-status"><a href="#service-docker-status" class="header-anchor">#</a> <code>service docker status</code></h3> <blockquote><p>查看docker运行状态</p></blockquote> <h3 id="systemctl-enable-docker"><a href="#systemctl-enable-docker" class="header-anchor">#</a> <code>systemctl enable docker</code></h3> <blockquote><p>设置开机自启</p></blockquote> <h3 id="docker-info"><a href="#docker-info" class="header-anchor">#</a> <code>docker info</code></h3> <blockquote><p>查看docker信息</p></blockquote> <h3 id="docker-help"><a href="#docker-help" class="header-anchor">#</a> <code>docker --help</code></h3> <blockquote><p>查看docker帮助文档</p></blockquote> <h3 id="docker-命令-help"><a href="#docker-命令-help" class="header-anchor">#</a> <code>docker [命令] --help</code></h3> <blockquote><p>查看相关命令帮助文档</p></blockquote> <h3 id="docker-images"><a href="#docker-images" class="header-anchor">#</a> <code>docker images</code></h3> <blockquote><p>查看本地所有镜像</p> <p><code>docker image ls</code></p></blockquote> <ul><li><code>-a</code>查看本地所有镜像</li> <li><code>-q</code>只查看镜像ID</li></ul> <h3 id="docker-search-images"><a href="#docker-search-images" class="header-anchor">#</a> <code>docker search [images]</code></h3> <blockquote><p>查询某个镜像</p></blockquote> <img src="/study/assets/img/image-20231118142340774.91efecaa.png" alt="image-20231118142340774" style="zoom:80%;"> <p><strong>OFFICIAL的值为<code>OK</code>表示该镜像为官方认证</strong></p> <ul><li><code>--limit &lt;num&gt;</code>只显示&lt;num&gt;个镜像</li></ul> <h3 id="docker-pull-images"><a href="#docker-pull-images" class="header-anchor">#</a> <code>docker pull [images]</code></h3> <blockquote><p>拉取某个镜像</p></blockquote> <ul><li><code>docker pull [images]:TAG</code>指定镜像的版本, 不加<code>:TAG</code>默认为最新版, 等价于<code>docker pull [images]:latest</code></li></ul> <img src="/study/assets/img/image-20231118143715975.0917c07d.png" alt="image-20231118143715975" style="zoom:80%;"> <h3 id="给镜像设置别名-打标签"><a href="#给镜像设置别名-打标签" class="header-anchor">#</a> 给镜像设置别名/打标签</h3> <blockquote><p>docker不能直接给镜像设置别名, 但可以通过设置标签来达到设置别名的目的</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> tag <span class="token operator">&lt;</span>image_id<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>repository<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span>
<span class="token comment"># image_id:    要打标签的镜像</span>
<span class="token comment"># repository:  仓库名称&lt;这个玩意通常不用指定&gt;</span>
<span class="token comment"># tag: 		   别名</span>

<span class="token comment"># example</span>
<span class="token function">docker</span> tag 967ca3be8ed4 mynginx
<span class="token comment"># 然后就可以使用这个名字创建容器了</span>
<span class="token function">docker</span> run <span class="token punctuation">..</span>. mynginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><img src="/study/assets/img/image-20240423163634328.e008e5dc.png" alt="image-20240423163634328" style="zoom:80%;"> <p>执行<code>docker images</code>会发现多了一个镜像</p> <p>那么是不是可以认为执行<code>docker tag</code>命令后, 会复制已有的镜像取个别名或者软链接之类的???</p> <p>==执行<code>tag</code>命令没有复制也没有创建额外的文件, 而是创建一个标签映射, 多个标签可以指向同一个镜像, 因此, <code>docker tag</code>命令创建的标签不会导致额外的空间消耗==</p> <img src="/study/assets/img/image-20240423164301885.e21c380f.png" alt="image-20240423164301885" style="zoom:80%;"> <p>它们两个的镜像ID都是一样的, 所以只是指向, <s>有点软链接的意思</s></p> <p>删除源镜像时, 会提示有引用无法删除, 必须强制删除</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Error response from daemon: conflict: unable to delete 7614ae9453d1 <span class="token punctuation">(</span>must be forced<span class="token punctuation">)</span> - image is referenced <span class="token keyword">in</span> multiple repositories
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>先删除tag别名镜像, 然后再删除源镜像</p> <h3 id="docker-system-df"><a href="#docker-system-df" class="header-anchor">#</a> <code>docker system df</code></h3> <blockquote><p>查看镜像容器所占空间</p></blockquote> <img src="/study/assets/img/image-20231118144403185.4c9a08d6.png" alt="image-20231118144403185" style="zoom:80%;"> <h3 id="docker-rmi-镜像名称-镜像id"><a href="#docker-rmi-镜像名称-镜像id" class="header-anchor">#</a> <code>docker rmi [镜像名称|镜像ID]</code></h3> <blockquote><p>删除指定镜像</p> <p>在删除前需要先停止引用容器</p></blockquote> <ul><li><code>-f</code>强制删除</li> <li><code>docker rmi &lt;image&gt; &lt;image&gt;</code>一次删除多个镜像, 镜像名或镜像ID用<strong>空格</strong>隔开</li> <li><code>docker rmi $(docker images -qa)</code>删除全部镜像, docker命令是支持参数续传的, 一般会加<code>-f</code>一起使用</li></ul> <h3 id="什么是docker虚悬镜像"><a href="#什么是docker虚悬镜像" class="header-anchor">#</a> 什么是docker虚悬镜像?</h3> <blockquote><p>虚悬镜像是指docker镜像的仓库名、镜像名、标签都为&lt;none&gt;的镜像</p></blockquote> <p>指那些不在与任何容器相关联的镜像, 这些镜像的产生可能是因为构建的版本或镜像删除不彻底所留下的</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 可以通过此命令查看虚悬镜像</span>
<span class="token function">docker</span> image <span class="token function">ls</span> <span class="token parameter variable">-f</span> <span class="token assign-left variable">dangling</span><span class="token operator">=</span>true
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>可以使用<code>docker image prune</code>清理残留镜像</p> <p>==<strong>对于容器, 此命令会将已停止的容器删除, 因此为了防止数据的丢失, 即时做好备份</strong>==</p> <h3 id="docker-run-options-image"><a href="#docker-run-options-image" class="header-anchor">#</a> <code>docker run [options] image</code></h3> <blockquote><p>创建并启动一个镜像</p></blockquote> <p>这个命令在运行时会先去本地查找, 找不到再去仓库拉取</p> <ul><li><p><code>options: --name</code>为容器指定一个新名称</p></li> <li><p><code>options: -d</code>启动守护式容器, 也是后台启动, 启动成功会返回容器ID</p></li> <li><p><code>options: -i</code>以交互模式运行容器</p></li> <li><p><code>options: -t</code>为容器重新分配一个伪输入终端, 通常&lt;i&gt;和&lt;t&gt;一起使用</p></li> <li><p><code>options: -P</code>随机端口映射</p></li> <li><p><code>options: -p</code>指定端口映射</p></li> <li><p><code>options: --rm</code>容器停止后, 自动删除</p> <table><thead><tr><th style="text-align:left;">参数</th> <th style="text-align:left;">说明</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>-p hostPort:containerPort</code></td> <td style="text-align:left;">端口映射 -p 8080:80</td></tr></tbody></table></li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># example</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> mynginx <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 nginx
<span class="token comment"># example</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">--rm</span> nginx
<span class="token comment"># 运行nginx容器且映射端口80 当容器停止后, 自动删除容器实例</span>
<span class="token comment"># 还有一个要注意的点, 如果容器不指定版本则默认会找latest版本, 而你又没有安装latest版, 所以极大概率会Unable to find image 'nginx:latest' locally错误!!!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><img src="/study/assets/img/image-20240423150640835.48175b1e.png" alt="image-20240423150640835" style="zoom:80%;"> <h3 id="docker-ps"><a href="#docker-ps" class="header-anchor">#</a> <code>docker ps</code></h3> <blockquote><p>查看当前运行的容器</p> <p><strong>-a</strong> 查看所有容器包含已停止容器</p></blockquote> <h3 id="docker-start-容器名称-id"><a href="#docker-start-容器名称-id" class="header-anchor">#</a> <code>docker start [容器名称|ID]</code></h3> <blockquote><p>启动容器</p></blockquote> <h3 id="docker-restart"><a href="#docker-restart" class="header-anchor">#</a> <code>docker restart ...</code></h3> <blockquote><p>重启容器</p></blockquote> <h3 id="docker-stop"><a href="#docker-stop" class="header-anchor">#</a> <code>docker stop ...</code></h3> <blockquote><p>停止容器</p></blockquote> <h3 id="docker-kill"><a href="#docker-kill" class="header-anchor">#</a> <code>docker kill ...</code></h3> <blockquote><p>杀死容器|强制停止容器</p></blockquote> <h3 id="docker-rm-容器id"><a href="#docker-rm-容器id" class="header-anchor">#</a> <code>docker rm [容器ID]</code></h3> <ul><li><p><code>docker rm -f $(docker ps -qa)</code></p></li> <li><p><code>docker ps -qa | xargs docker rm</code>同上删除多个容器</p> <p>xargs: 将上一个命令的输出作为下一个命令的参数</p> <p>-f: 强制删除</p></li></ul> <h3 id="docker-logs-容器id"><a href="#docker-logs-容器id" class="header-anchor">#</a> <code>docker logs [容器ID]</code></h3> <blockquote><p>查看容器日志</p></blockquote> <h3 id="docker-top-容器id"><a href="#docker-top-容器id" class="header-anchor">#</a> <code>docker top [容器ID]</code></h3> <blockquote><p>查看容器实例信息</p></blockquote> <h3 id="docker-inspect-container-id-or-name"><a href="#docker-inspect-container-id-or-name" class="header-anchor">#</a> <code>docker inspect [container_id_or_name]</code></h3> <blockquote><p>查看容器实例详细信息</p></blockquote> <img src="/study/assets/img/image-20231118185524246.01cfa2d5.png" alt="image-20231118185524246" style="zoom:80%;"> <h3 id="docker-exec-it-容器id"><a href="#docker-exec-it-容器id" class="header-anchor">#</a> <code>docker exec -it [容器ID]</code></h3> <blockquote><p>进入指定容器</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span> container <span class="token builtin class-name">command</span> <span class="token punctuation">[</span>arg<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
<span class="token comment"># options:   可选命令参数</span>
<span class="token comment"># container: 容器名称或ID</span>
<span class="token comment"># command:   要在容器中执行的指令</span>
<span class="token comment"># arg:		 command所附带的指令参数</span>

<span class="token comment"># 这个命令通常这么使用</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> container /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><code>docker exec</code>需要至少两个参数才可以执行</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> nginx	<span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&quot;docker exec&quot;</span> requires at least <span class="token number">2</span> arguments.
<span class="token comment"># -it 不算参数, 所以需要指定bash路径   docker exec -it nginx /bin/bash</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="docker-attach-容器id"><a href="#docker-attach-容器id" class="header-anchor">#</a> <code>docker attach [容器ID]</code></h3> <blockquote><p>同上</p></blockquote> <p><strong>不同的是: attach进入容器不会启动新的进程, 执行<code>exit</code>命令后会停止容器, 而使用exec进入容器会启动新的进程, 执行<code>exit</code>命令后容器不会停止</strong></p> <p>==进入容器后, 可以使用<code>ctrl</code>+<code>p</code>+<code>q</code>退出==</p> <h2 id="镜像和容器的关系"><a href="#镜像和容器的关系" class="header-anchor">#</a> 镜像和容器的关系?</h2> <blockquote><p>容器是镜像的实例, 是基于镜像而创建的实例</p></blockquote> <p>以Java角度来讲, 镜像就是类Class, 而容器就是类的对象实例</p> <p>镜像: 一个只读的文件系统快照, 包含运行容器所需要的所有内容, 是容器的基础, 可以看做是容器的蓝图或模板</p> <p>容器: 基于镜像而创建的实例, 启动容器时, Docker会基于指定的镜像创建一个新的容器实例并在其上运行指定的命令, 容器可以被启动、停止、删除等操作, 它是一个独立的运行环境, 拥有自己的一套东西, 比如: 文件系统、网络环境、进程空间等.</p> <h3 id="docker-network-ls"><a href="#docker-network-ls" class="header-anchor">#</a> <code>docker network ls</code></h3> <blockquote><p>列出所有网络</p></blockquote> <h3 id="docker-network-create-network-name"><a href="#docker-network-create-network-name" class="header-anchor">#</a> <code>docker network create &lt;network_name&gt;</code></h3> <blockquote><p>创建一个新的网络</p></blockquote> <h2 id="docker网络"><a href="#docker网络" class="header-anchor">#</a> Docker网络?</h2> <blockquote><p>一个虚拟的网络, 可以让多个docker容器相互通信交互</p></blockquote> <p>使用docker网络可以实现以下目的</p> <ul><li><p>隔离容器</p> <p>每一个docker网络都一个独立隔离的网络环境, 不同网络之间无法直接通信, 除非进行网络连接</p></li> <li><p>容器通信</p> <p>将容器连接到同一个网络下, 可以使容器间相互通信, 而不需要将端口暴露到主机上</p></li> <li><p>跨主机通信</p></li></ul> <h3 id="docker-network-connect-network-name-container-id-or-name"><a href="#docker-network-connect-network-name-container-id-or-name" class="header-anchor">#</a> <code>docker network connect &lt;network_name&gt; &lt;container_id_or_name&gt;</code></h3> <blockquote><p>指定容器连接指定网络</p> <p><code>disconnect</code>: 断开连接</p></blockquote> <h2 id="文件拷贝"><a href="#文件拷贝" class="header-anchor">#</a> 文件拷贝</h2> <blockquote><p>容器内文件备份到主机</p></blockquote> <p><code>docker cp &lt;container_id&gt;:&lt;path&gt; &lt;path&gt;</code></p> <p>container_id: 容器ID</p> <p>第一个path:   容器内文件的路径&lt;可以是一个目录&gt;</p> <p>第二个path:   目标路径</p> <h2 id="导出容器"><a href="#导出容器" class="header-anchor">#</a> 导出容器</h2> <blockquote><p>这个操作可以让我们的容器在不同环境下运行且可以共享容器</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">export</span> <span class="token operator">&lt;</span>container_id<span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>.tar
<span class="token comment"># 这个操作可以直接备份整个容器</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="导入容器"><a href="#导入容器" class="header-anchor">#</a> 导入容器</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token function">import</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>.tar <span class="token operator">&lt;</span>repository<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span>
<span class="token comment"># 如果不指定仓库, 就会出现虚悬镜像</span>
<span class="token comment"># 在启动时, 需要使用docker run -it &lt;image_id&gt; /bin/bash</span>
<span class="token comment"># 因为它是个容器所以不能单纯使用run命令</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="docker镜像层都是只读的-容器层是可写的"><a href="#docker镜像层都是只读的-容器层是可写的" class="header-anchor">#</a> Docker镜像层都是只读的, 容器层是可写的</h2> <blockquote><p>docker在启动时, 一个最新的可写层被加载到镜像的最顶层, <strong>这一层通常被称为容器层, 容器层之下的都是镜像层</strong></p></blockquote> <img src="/study/assets/img/image-20240430165415446.f59619cc.png" alt="image-20240430165415446" style="zoom:80%;"> <p><strong>所有对容器的操作, 不管是添加、删除、修改文件等都只是发生在容器层中, 只有容器是可写的, 容器层之下镜像层都是只读的</strong></p> <p><strong>拓展:</strong>==bootfs是docker镜像中最底层的文件系统, 通常情况下该文件是只读的, 类似于一个基本的linux发行版, 这个文件系统包含了最基本的系统文件和目录, 例如:/bin/sbin/lib等 bootfs是docker镜像的基础, 上层的层叠文件系统在其之上进行构建, 从而实现镜像的分层和可修改性==</p> <h2 id="docker-commit"><a href="#docker-commit" class="header-anchor">#</a> <code>docker commit</code></h2> <blockquote><p>以当前镜像为基础保存为一个新的镜像</p></blockquote> <p>比如, 我们拉取了一个新的ubuntu镜像, 但这个镜像没有vim命令, 我们就可以安装一个vim依赖, 并将含有vim命令的镜像发布为一个新的镜像, 这样在拉取新ubuntu镜像时, 就含有vim命令了</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> commit <span class="token punctuation">[</span>options<span class="token punctuation">]</span> container <span class="token punctuation">[</span>repository<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span>
<span class="token comment"># container:  要保存为镜像的已运行状态的容器名称或ID</span>
<span class="token comment"># repository: 要创建的新镜像名称</span>
<span class="token comment"># tag:		  镜像标签, 可选</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>拉取centos镜像</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull centos:7
<span class="token comment"># 设置别名</span>
<span class="token function">docker</span> tag eeb6ee3f44bd mylinux
<span class="token comment"># 运行容器并执行vim命令</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> mylinux /bin/bash
<span class="token punctuation">[</span>root@b5bcf936781c /<span class="token punctuation">]</span><span class="token comment"># vim test.txt</span>
<span class="token comment"># 然后就会出现找不到vim</span>
bash: vim: <span class="token builtin class-name">command</span> not found
<span class="token comment"># 安装vim</span>
yum update <span class="token operator">&amp;&amp;</span> <span class="token function">yes</span> <span class="token operator">|</span> yum <span class="token function">install</span> <span class="token function">vim</span>
<span class="token comment"># 然后再使用vim命令已经可以正常使用了</span>
<span class="token comment"># 接下来, 以安装vim命令的centos镜像为基础, commit一个新的centos镜像</span>
<span class="token function">docker</span> commit <span class="token parameter variable">-a</span> <span class="token string">&quot;naihe&quot;</span> <span class="token parameter variable">-m</span> <span class="token string">&quot;add vim&quot;</span> mycentos havevimcentos
<span class="token comment"># 然后运行这个容器并执行vim命令, 然后就会发现在新的镜像中没有安装vim命令也可以使用vim了</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>==通常不会这么去做, 一般采用<code>Dockerfile</code>文件构建镜像==</p> <h2 id="docker推送镜像到私服"><a href="#docker推送镜像到私服" class="header-anchor">#</a> docker推送镜像到私服</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 下载registry</span>
<span class="token function">docker</span> pull registry
<span class="token comment"># 运行私服</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">5000</span>:5000 <span class="token parameter variable">-v</span> /naihe/myregistry/:/tmp/registry <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true registry
<span class="token comment"># 查看私服镜像</span>
<span class="token function">curl</span> <span class="token parameter variable">-XGET</span> http://localhost:5000/v2/_catalog
<span class="token punctuation">{</span><span class="token string">&quot;repositories&quot;</span>:<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token comment"># 刚开始结果肯定为空, 因为还没有上传私服镜像</span>
<span class="token comment"># 上传私服镜像</span>
<span class="token function">docker</span> tag 967ca3be8ed4 localhost:5000/nginx
<span class="token function">docker</span> push localhost:5000/nginx
<span class="token comment"># 这时查看私服镜像已经有nginx镜像了</span>
<span class="token function">curl</span> <span class="token parameter variable">-XGET</span> http://localhost:5000/v2/_catalog
<span class="token punctuation">{</span><span class="token string">&quot;repositories&quot;</span>:<span class="token punctuation">[</span><span class="token string">&quot;nginx&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token comment"># 拉取私服nginx镜像</span>
<span class="token function">docker</span> pull localhost:5000/nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="docker容器数据"><a href="#docker容器数据" class="header-anchor">#</a> docker容器数据</h2> <blockquote><p>Docker提供的一种数据持久化存储机制, 用于在容器和宿主机之前进行数据共享, 并且可以在==容器删除后保留数据==</p> <p>对文件的修改都是相互的, 在宿主机上所做的修改会同步到容器中, 反之也是一样</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-v</span> <span class="token punctuation">[</span>宿主机目录<span class="token punctuation">]</span>:<span class="token punctuation">[</span>容器目录<span class="token punctuation">]</span> <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true <span class="token punctuation">[</span>ImageID<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以nginx为例</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> mynginx <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">-v</span> /home/naihe/docker_nginx/html:/data/html <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /home/naihe/docker_nginx/logs:/data/logs <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /home/naihe/docker_nginx/nginx.conf:/etc/nginx/nginx.conf <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true mynginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>可以通过<code>docker inspect &lt;container&gt;</code>来查看是否挂载成功</p> <img src="/study/assets/img/image-20240501102511216.25badb9f.png" alt="image-20240501102511216" style="zoom:80%;"> <p><strong>如果修改文件后没有生效, 重启容器就好<code>docker restart mynginx</code></strong></p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token comment"># nginx不允许location /配置块使用相对路径的root</span>
<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> example.com</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">root</span> /var/www</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">root</span> /var/www/images</span><span class="token punctuation">;</span> <span class="token comment"># 要么不写, 要么写绝对路径</span>
        <span class="token comment"># 将会使用 /var/www/images 作为根目录</span>
    <span class="token punctuation">}</span>

    <span class="token directive"><span class="token keyword">location</span> /./image/</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">root</span> images</span><span class="token punctuation">;</span>
        <span class="token comment"># 将会使用 /var/www/images 作为根目录</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="可以通过ro或rw指定容器对数据卷的权限"><a href="#可以通过ro或rw指定容器对数据卷的权限" class="header-anchor">#</a> 可以通过ro或rw指定容器对数据卷的权限</h3> <ul><li>rw: 可读可写</li> <li>ro: 只读</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-v</span> /home/naihe/docker_nginx/html:/data/html:ro mynginx
<span class="token comment"># 也可以使用--mount命令</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,source<span class="token operator">=</span>/home/naihe/docker_nginx/html,target<span class="token operator">=</span>/data/html,readonly<span class="token operator">=</span>true mynginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="数据卷之间的继承和共享"><a href="#数据卷之间的继承和共享" class="header-anchor">#</a> 数据卷之间的继承和共享</h3> <blockquote><p>可以让一个容器共享另一个容器的数据</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true --volumes-from mynginx1 mynginx2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>假设mynginx1停止了, 是不影响mynginx2的, 在mynginx2中修改文件依旧可以同步到宿主机上
这时mynginx1启动, 是可以同步mynginx2的修改
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="docker安装mysql"><a href="#docker安装mysql" class="header-anchor">#</a> docker安装mysql</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull mysql
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--rm</span> <span class="token parameter variable">--name</span> mysql <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>root <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 mysql
<span class="token comment"># 查看一下mysql的编码</span>
show variables like <span class="token string">'character%'</span><span class="token punctuation">;</span>
<span class="token comment"># 如果不是utf8, 在插入中文数据时会有编码错误</span>
<span class="token comment"># 一般来讲mysql8不会有这个问题, 5版本出现的几率比较大</span>

<span class="token comment"># 持久化mysql数据</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--rm</span> <span class="token parameter variable">--name</span> mysql <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>root <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /home/naihe/docker_mysql/data:/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /home/naihe/docker_mysql/log:/var/log/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /home/naihe/docker_mysql/conf/mysql.conf:/etc/mysql/conf.d/mysql.conf mysql
<span class="token comment"># 配置文件不能出错 不然启动失败</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="docker安装redis"><a href="#docker安装redis" class="header-anchor">#</a> docker安装redis</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull redis:6
<span class="token comment"># 启动redis</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> myredis <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 <span class="token parameter variable">--rm</span> <span class="token parameter variable">-v</span> /home/naihe/docker_redis/data:/data <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /home/naihe/docker_redis/conf/redis.conf:/etc/redis/redis.conf <span class="token parameter variable">-d</span> <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true myredis redis-server /etc/redis/redis.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="docker安装mongodb"><a href="#docker安装mongodb" class="header-anchor">#</a> docker安装mongodb</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull mongo
/data/db
/var/log/mongodb
/etc/mongod.conf

<span class="token function">docker</span> run <span class="token parameter variable">--rm</span> <span class="token parameter variable">--name</span> mongodb <span class="token parameter variable">-p</span> <span class="token number">27017</span>:27017 <span class="token parameter variable">-d</span> <span class="token parameter variable">-v</span> /home/naihe/docker_mongo/data:/data/db <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /home/naihe/docker_mongo/config/mongod.conf:/etc/mongod.conf <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /home/naihe/docker_mongo/log:/var/log/mongodb <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true dfda7a2cf273 <span class="token parameter variable">--auth</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="docker部署springboot应用"><a href="#docker部署springboot应用" class="header-anchor">#</a> docker部署SpringBoot应用</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>FROM openjdk:11-jre-slim

COPY my-site.jar app.jar

EXPOSE <span class="token number">8088</span>

ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;java&quot;</span>, <span class="token string">&quot;-jar&quot;</span>, <span class="token string">&quot;app.jar&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> Dockerfile</h2> <blockquote><p>构建docker镜像的文件</p> <p>只是构建</p></blockquote> <p><a href="https://docs.docker.com/reference/dockerfile" target="_blank" rel="noopener noreferrer">构建参数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="docker执行dockerfile的流程"><a href="#docker执行dockerfile的流程" class="header-anchor">#</a> docker执行Dockerfile的流程</h3> <ul><li>docker从基础镜像运行一个容器</li> <li>执行相关指令对容器做出修改</li> <li>执行类似commit的操作提交一个新的镜像层</li> <li>基础新的镜像运行一个容器</li> <li>执行Dockerfile下一条指令直到所有的指令运行完成</li></ul> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token comment"># 不区分大小写</span>
<span class="token comment"># 使用官方 Nginx 镜像作为基础镜像</span>
<span class="token instruction"><span class="token keyword">FROM</span> nginx:1.24.0</span>

<span class="token comment"># 将本地的 Nginx 配置文件复制到容器内的 /etc/nginx/ 目录下</span>
<span class="token instruction"><span class="token keyword">COPY</span> nginx.conf /etc/nginx/nginx.conf</span>

<span class="token comment"># 复制静态网页文件到 Nginx 默认的网页目录 /usr/share/nginx/html/</span>
<span class="token instruction"><span class="token keyword">COPY</span> ./html /usr/share/nginx/html/</span>

<span class="token comment"># 暴露 Nginx 监听的端口（默认为 80）</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 80</span>

<span class="token comment"># 指定容器启动时运行的命令，启动 Nginx 服务</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;nginx&quot;</span>, <span class="token string">&quot;-g&quot;</span>, <span class="token string">&quot;daemon off;&quot;</span>]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> myblog <span class="token builtin class-name">.</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 myblog
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/study/assets/js/app.6d3630f5.js" defer></script><script src="/study/assets/js/2.40365491.js" defer></script><script src="/study/assets/js/1.eec64618.js" defer></script><script src="/study/assets/js/18.ba9636f0.js" defer></script>
  </body>
</html>
